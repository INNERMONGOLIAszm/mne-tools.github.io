<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>mne.connectivity.spectral_connectivity &mdash; MNE 0.10.dev0 documentation</title>
    
    <link rel="stylesheet" href="../_static/navy.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.10.dev0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="MNE 0.10.dev0 documentation" href="../index.html" />
    <link rel="up" title="API Reference" href="../python_reference.html" />
    <link rel="next" title="mne.connectivity.phase_slope_index" href="mne.connectivity.phase_slope_index.html" />
    <link rel="prev" title="mne.connectivity.seed_target_indices" href="mne.connectivity.seed_target_indices.html" />

<link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,400,700' rel='stylesheet' type='text/css'>


    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-37225609-1']);
    _gaq.push(['_trackPageview']);

    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>



    <script type="text/javascript">
    !function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);
    js.id=id;js.src="http://platform.twitter.com/widgets.js";
    fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");
    </script>



    <script type="text/javascript">
    (function() {
    var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
    po.src = 'https://apis.google.com/js/plusone.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
    })();
    </script>


  </head>
  <body role="document">

<div style="background-color: red; color: white; font-weight:bold; text-align: center; padding: 10px; min-width: 910px">
This documentation is for the development version (0.10.dev0) - <a href="http://martinos.org/mne/stable">Stable version</a>
</div>

<div style="background-color: white; text-align: left; padding: 10px 7px 15px 15px; min-width: 910px">
<div style="float: left">
<a href="../index.html"><img src="../_static/mne_logo.png" border="0" alt="py4sci"/></a>
</div>

<div style="float: right">
<a href="../index.html"><img src="../_static/institutions.png" border="0" alt="py4sci"/></a>
</div>
<br style="clear:both"/>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../np-modindex.html" title="Python Module Index"
             >modules</a></li>
        <li class="right" >
          <a href="mne.connectivity.phase_slope_index.html" title="mne.connectivity.phase_slope_index"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="mne.connectivity.seed_target_indices.html" title="mne.connectivity.seed_target_indices"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">Home</a>&nbsp;|&nbsp;</li>
        <li><a href="../manual.html">Manual</a>&nbsp;|&nbsp;</li>
        <li><a href="../mne-python.html">Python</a>&nbsp;|&nbsp;</li>
        <li><a href="../cite.html">Cite MNE</a>&nbsp;|&nbsp;</li>
        <!-- <li><a href="../search.html">Search</a></li> -->

          <li class="nav-item nav-item-1"><a href="../mne-python.html" >MNE with Python</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="../python_reference.html" accesskey="U">API Reference</a> &raquo;</li> 
      </ul>
    </div>

      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h3><a href="../index.html">Table Of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../manual.html">Manual</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../mne-python.html">MNE with Python</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../getting_started.html">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../advanced_setup.html">Advanced installation and setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_tutorial.html">Tutorial: MEG and EEG data processing with MNE and Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mne_report_tutorial.html">Tutorial: Getting started with MNE report command</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_examples/index.html">Examples</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../python_reference.html">API Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../whats_new.html">What&#8217;s new</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing.html">Contributing to <em>mne-python</em> source code</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../mne-cpp.html">MNE with CPP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cite.html">Cite MNE and MNE-Python</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script><h3>Versions</h3>
<ul class="current">
    <li class="toctree-l1"><a href=http://martinos.org/mne/stable>Stable</a></li>
    <li class="toctree-l1"><a href=http://martinos.org/mne/dev>Development</a></li>
</ul>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="mne-connectivity-spectral-connectivity">
<h1>mne.connectivity.spectral_connectivity<a class="headerlink" href="#mne-connectivity-spectral-connectivity" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="mne.connectivity.spectral_connectivity">
<code class="descclassname">mne.connectivity.</code><code class="descname">spectral_connectivity</code><span class="sig-paren">(</span><em>data</em>, <em>method='coh'</em>, <em>indices=None</em>, <em>sfreq=6.283185307179586</em>, <em>mode='multitaper'</em>, <em>fmin=None</em>, <em>fmax=inf</em>, <em>fskip=0</em>, <em>faverage=False</em>, <em>tmin=None</em>, <em>tmax=None</em>, <em>mt_bandwidth=None</em>, <em>mt_adaptive=False</em>, <em>mt_low_bias=True</em>, <em>cwt_frequencies=None</em>, <em>cwt_n_cycles=7</em>, <em>block_size=1000</em>, <em>n_jobs=1</em>, <em>verbose=None</em><span class="sig-paren">)</span><a class="headerlink" href="#mne.connectivity.spectral_connectivity" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute various frequency-domain and time-frequency domain connectivity
measures.</p>
<p>The connectivity method(s) are specified using the &#8220;method&#8221; parameter.
All methods are based on estimates of the cross- and power spectral
densities (CSD/PSD) Sxy and Sxx, Syy.</p>
<p>The spectral densities can be estimated using a multitaper method with
digital prolate spheroidal sequence (DPSS) windows, a discrete Fourier
transform with Hanning windows, or a continuous wavelet transform using
Morlet wavelets. The spectral estimation mode is specified using the
&#8220;mode&#8221; parameter.</p>
<p>By default, the connectivity between all signals is computed (only
connections corresponding to the lower-triangular part of the
connectivity matrix). If one is only interested in the connectivity
between some signals, the &#8220;indices&#8221; parameter can be used. For example,
to compute the connectivity between the signal with index 0 and signals
&#8220;2, 3, 4&#8221; (a total of 3 connections) one can use the following:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">indices</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span>    <span class="c"># row indices</span>
           <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]))</span>    <span class="c"># col indices</span>

<span class="n">con_flat</span> <span class="o">=</span> <span class="n">spectral_connectivity</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s">&#39;coh&#39;</span><span class="p">,</span>
                                 <span class="n">indices</span><span class="o">=</span><span class="n">indices</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
<p>In this case con_flat.shape = (3, n_freqs). The connectivity scores are
in the same order as defined indices.</p>
<p><strong>Supported Connectivity Measures</strong></p>
<p>The connectivity method(s) is specified using the &#8220;method&#8221; parameter. The
following methods are supported (note: <code class="docutils literal"><span class="pre">E[]</span></code> denotes average over
epochs). Multiple measures can be computed at once by using a list/tuple,
e.g., <code class="docutils literal"><span class="pre">['coh',</span> <span class="pre">'pli']</span></code> to compute coherence and PLI.</p>
<blockquote>
<div><p>&#8216;coh&#8217; : Coherence given by:</p>
<div class="highlight-python"><div class="highlight"><pre>         | E[Sxy] |
C = ---------------------
    sqrt(E[Sxx] * E[Syy])
</pre></div>
</div>
<p>&#8216;cohy&#8217; : Coherency given by:</p>
<div class="highlight-python"><div class="highlight"><pre>           E[Sxy]
C = ---------------------
    sqrt(E[Sxx] * E[Syy])
</pre></div>
</div>
<p>&#8216;imcoh&#8217; : Imaginary coherence <a class="reference internal" href="#r13" id="id1">[R13]</a> given by:</p>
<div class="highlight-python"><div class="highlight"><pre>          Im(E[Sxy])
C = ----------------------
    sqrt(E[Sxx] * E[Syy])
</pre></div>
</div>
<p>&#8216;plv&#8217; : Phase-Locking Value (PLV) <a class="reference internal" href="#r14" id="id2">[R14]</a> given by:</p>
<div class="highlight-python"><div class="highlight"><pre>PLV = |E[Sxy/|Sxy|]|
</pre></div>
</div>
<p>&#8216;ppc&#8217; : Pairwise Phase Consistency (PPC), an unbiased estimator
of squared PLV <a class="reference internal" href="#r15" id="id3">[R15]</a>.</p>
<p>&#8216;pli&#8217; : Phase Lag Index (PLI) <a class="reference internal" href="#r16" id="id4">[R16]</a> given by:</p>
<div class="highlight-python"><div class="highlight"><pre>PLI = |E[sign(Im(Sxy))]|
</pre></div>
</div>
<p>&#8216;pli2_unbiased&#8217; : Unbiased estimator of squared PLI <a class="reference internal" href="#r17" id="id5">[R17]</a>.</p>
<p>&#8216;wpli&#8217; : Weighted Phase Lag Index (WPLI) <a class="reference internal" href="#r17" id="id6">[R17]</a> given by:</p>
<div class="highlight-python"><div class="highlight"><pre>          |E[Im(Sxy)]|
WPLI = ------------------
          E[|Im(Sxy)|]
</pre></div>
</div>
<p>&#8216;wpli2_debiased&#8217; : Debiased estimator of squared WPLI [5].</p>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>data</strong> : array, shape=(n_epochs, n_signals, n_times)</p>
<blockquote>
<div><blockquote>
<div><p>or list/generator of array, shape =(n_signals, n_times)
or list/generator of SourceEstimate or VolSourceEstimate
or Epochs</p>
</div></blockquote>
<p>The data from which to compute connectivity. Note that it is also
possible to combine multiple signals by providing a list of tuples,
e.g., data = [(arr_0, stc_0), (arr_1, stc_1), (arr_2, stc_2)],
corresponds to 3 epochs, and arr_* could be an array with the same
number of time points as stc_*.</p>
</div></blockquote>
<p><strong>method</strong> : string | list of string</p>
<blockquote>
<div><p>Connectivity measure(s) to compute.</p>
</div></blockquote>
<p><strong>indices</strong> : tuple of arrays | None</p>
<blockquote>
<div><p>Two arrays with indices of connections for which to compute
connectivity. If None, all connections are computed.</p>
</div></blockquote>
<p><strong>sfreq</strong> : float</p>
<blockquote>
<div><p>The sampling frequency.</p>
</div></blockquote>
<p><strong>mode</strong> : str</p>
<blockquote>
<div><p>Spectrum estimation mode can be either: &#8216;multitaper&#8217;, &#8216;fourier&#8217;, or
&#8216;cwt_morlet&#8217;.</p>
</div></blockquote>
<p><strong>fmin</strong> : float | tuple of floats</p>
<blockquote>
<div><p>The lower frequency of interest. Multiple bands are defined using
a tuple, e.g., (8., 20.) for two bands with 8Hz and 20Hz lower freq.
If None the frequency corresponding to an epoch length of 5 cycles
is used.</p>
</div></blockquote>
<p><strong>fmax</strong> : float | tuple of floats</p>
<blockquote>
<div><p>The upper frequency of interest. Multiple bands are dedined using
a tuple, e.g. (13., 30.) for two band with 13Hz and 30Hz upper freq.</p>
</div></blockquote>
<p><strong>fskip</strong> : int</p>
<blockquote>
<div><p>Omit every &#8220;(fskip + 1)-th&#8221; frequency bin to decimate in frequency
domain.</p>
</div></blockquote>
<p><strong>faverage</strong> : boolean</p>
<blockquote>
<div><p>Average connectivity scores for each frequency band. If True,
the output freqs will be a list with arrays of the frequencies
that were averaged.</p>
</div></blockquote>
<p><strong>tmin</strong> : float | None</p>
<blockquote>
<div><p>Time to start connectivity estimation. Note: when &#8220;data&#8221; is an array,
the first sample is assumed to be at time 0. For other types
(Epochs, etc.), the time information contained in the object is used
to compute the time indices.</p>
</div></blockquote>
<p><strong>tmax</strong> : float | None</p>
<blockquote>
<div><p>Time to end connectivity estimation. Note: when &#8220;data&#8221; is an array,
the first sample is assumed to be at time 0. For other types
(Epochs, etc.), the time information contained in the object is used
to compute the time indices.</p>
</div></blockquote>
<p><strong>mt_bandwidth</strong> : float | None</p>
<blockquote>
<div><p>The bandwidth of the multitaper windowing function in Hz.
Only used in &#8216;multitaper&#8217; mode.</p>
</div></blockquote>
<p><strong>mt_adaptive</strong> : bool</p>
<blockquote>
<div><p>Use adaptive weights to combine the tapered spectra into PSD.
Only used in &#8216;multitaper&#8217; mode.</p>
</div></blockquote>
<p><strong>mt_low_bias</strong> : bool</p>
<blockquote>
<div><p>Only use tapers with more than 90% spectral concentration within
bandwidth. Only used in &#8216;multitaper&#8217; mode.</p>
</div></blockquote>
<p><strong>cwt_frequencies</strong> : array</p>
<blockquote>
<div><p>Array of frequencies of interest. Only used in &#8216;cwt_morlet&#8217; mode.</p>
</div></blockquote>
<p><strong>cwt_n_cycles: float | array of float</strong> :</p>
<blockquote>
<div><p>Number of cycles. Fixed number or one per frequency. Only used in
&#8216;cwt_morlet&#8217; mode.</p>
</div></blockquote>
<p><strong>block_size</strong> : int</p>
<blockquote>
<div><p>How many connections to compute at once (higher numbers are faster
but require more memory).</p>
</div></blockquote>
<p><strong>n_jobs</strong> : int</p>
<blockquote>
<div><p>How many epochs to process in parallel.</p>
</div></blockquote>
<p><strong>verbose</strong> : bool, str, int, or None</p>
<blockquote>
<div><p>If not None, override default verbose level (see mne.verbose).</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>con</strong> : array | list of arrays</p>
<blockquote>
<div><p>Computed connectivity measure(s). The shape of each array is either
(n_signals, n_signals, n_frequencies) mode: &#8216;multitaper&#8217; or &#8216;fourier&#8217;
(n_signals, n_signals, n_frequencies, n_times) mode: &#8216;cwt_morlet&#8217;
when &#8220;indices&#8221; is None, or
(n_con, n_frequencies) mode: &#8216;multitaper&#8217; or &#8216;fourier&#8217;
(n_con, n_frequencies, n_times) mode: &#8216;cwt_morlet&#8217;
when &#8220;indices&#8221; is specified and &#8220;n_con = len(indices[0])&#8221;.</p>
</div></blockquote>
<p><strong>freqs</strong> : array</p>
<blockquote>
<div><p>Frequency points at which the connectivity was computed.</p>
</div></blockquote>
<p><strong>times</strong> : array</p>
<blockquote>
<div><p>Time points for which the connectivity was computed.</p>
</div></blockquote>
<p><strong>n_epochs</strong> : int</p>
<blockquote>
<div><p>Number of epochs used for computation.</p>
</div></blockquote>
<p><strong>n_tapers</strong> : int</p>
<blockquote class="last">
<div><p>The number of DPSS tapers used. Only defined in &#8216;multitaper&#8217; mode.
Otherwise None is returned.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r13" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[R13]</td><td><em>(<a class="fn-backref" href="#id1">1</a>, <a class="fn-backref" href="#id7">2</a>)</em> Nolte et al. &#8220;Identifying true brain interaction from EEG data using
the imaginary part of coherency&#8221; Clinical neurophysiology, vol. 115,
no. 10, pp. 2292-2307, Oct. 2004.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r14" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[R14]</td><td><em>(<a class="fn-backref" href="#id2">1</a>, <a class="fn-backref" href="#id8">2</a>)</em> Lachaux et al. &#8220;Measuring phase synchrony in brain signals&#8221; Human
brain mapping, vol. 8, no. 4, pp. 194-208, Jan. 1999.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r15" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[R15]</td><td><em>(<a class="fn-backref" href="#id3">1</a>, <a class="fn-backref" href="#id9">2</a>)</em> Vinck et al. &#8220;The pairwise phase consistency: a bias-free measure of
rhythmic neuronal synchronization&#8221; NeuroImage, vol. 51, no. 1,
pp. 112-122, May 2010.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r16" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[R16]</td><td><em>(<a class="fn-backref" href="#id4">1</a>, <a class="fn-backref" href="#id10">2</a>)</em> Stam et al. &#8220;Phase lag index: assessment of functional connectivity
from multi channel EEG and MEG with diminished bias from common
sources&#8221; Human brain mapping, vol. 28, no. 11, pp. 1178-1193,
Nov. 2007.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r17" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[R17]</td><td><em>(<a class="fn-backref" href="#id5">1</a>, <a class="fn-backref" href="#id6">2</a>, <a class="fn-backref" href="#id11">3</a>)</em> Vinck et al. &#8220;An improved index of phase-synchronization for
electro-physiological data in the presence of volume-conduction,
noise and sample-size bias&#8221; NeuroImage, vol. 55, no. 4,
pp. 1548-1565, Apr. 2011.</td></tr>
</tbody>
</table>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2012-2015, MNE Developers.
      Last updated on May 22, 2015.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4a0+.
    </div>
  </body>
</html>