<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Artifact suppression &mdash; MNE 0.12.dev0 documentation</title>
    
    <link rel="stylesheet" href="../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/gallery.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootswatch-3.3.4/flatly/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/style.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.12.dev0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-3.3.4/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="top" title="MNE 0.12.dev0 documentation" href="../../index.html" />
    <link rel="up" title="Tutorials" href="../../tutorials.html" />
    <link rel="next" title="Compute ICA on MEG data and remove artifacts" href="../../auto_tutorials/plot_ica_from_raw.html" />
    <link rel="prev" title="Data selection" href="data_selection.html" />

<link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,400,700' rel='stylesheet' type='text/css'>


    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-37225609-1']);
    _gaq.push(['_trackPageview']);

    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>



    <script type="text/javascript">
    !function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);
    js.id=id;js.src="http://platform.twitter.com/widgets.js";
    fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");
    </script>



    <script type="text/javascript">
    (function() {
    var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
    po.src = 'https://apis.google.com/js/plusone.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
    })();
    </script>


  </head>
  <body role="document">

<div class="devbar">
This documentation is for the development version (0.12.dev0) - <a href="http://martinos.org/mne/stable">Stable version</a>
</div>





  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html"><img src="../../_static/mne_logo_small.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>0.12.dev0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../../getting_started.html">Get started</a></li>
                <li><a href="../../tutorials.html">Tutorials</a></li>
                <li><a href="../../auto_examples/index.html">Gallery</a></li>
                <li><a href="../../python_reference.html">API</a></li>
                <li><a href="../../manual/index.html">Manual</a></li>
                <li><a href="../../faq.html">FAQ</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../getting_started.html">Getting started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../auto_examples/index.html">Examples Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing.html">Contribute to MNE</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../python_reference.html">Python API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../manual/index.html">User Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../whats_new.html">What&#8217;s new</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../cite.html">How to cite MNE</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../references.html">Related publications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cited.html">Publications from MNE users</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Artifact suppression</a><ul>
<li><a class="reference internal" href="#independent-component-analysis-ica">Independent Component Analysis (ICA)</a></li>
<li><a class="reference internal" href="#signal-space-projection-ssp">Signal-Space Projection (SSP)</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/mne_logo_small.png" alt="Logo"/>
            </a></p><ul>
<li><a class="reference internal" href="#">Artifact suppression</a><ul>
<li><a class="reference internal" href="#independent-component-analysis-ica">Independent Component Analysis (ICA)</a></li>
<li><a class="reference internal" href="#signal-space-projection-ssp">Signal-Space Projection (SSP)</a></li>
</ul>
</li>
</ul>

  <li>
    <a href="data_selection.html" title="Previous Chapter: Data selection"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Data selection</span>
    </a>
  </li>
  <li>
    <a href="../../auto_tutorials/plot_ica_from_raw.html" title="Next Chapter: Compute ICA on MEG data and remove artifacts"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Compute ICA o... &raquo;</span>
    </a>
  </li>
<form action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
        </div>
      </div>
    <div class="col-md-12 content">
      
  <div class="section" id="artifact-suppression">
<h1>Artifact suppression<a class="headerlink" href="#artifact-suppression" title="Permalink to this headline">¶</a></h1>
<p>Typical M/EEG data contain some artifacts; we first identify them, then we remove them.</p>
<dl class="docutils">
<dt>Typical artifacts includes:</dt>
<dd><ul class="first last simple">
<li>Blinks (recorded through EOG)</li>
<li>Heartbeats (recorded through ECG)</li>
</ul>
</dd>
</dl>
<p>To extract the spatio-temporal contribution of blinks and heartbeats, you
can use either ICA or SSP; we recommend to use ICA.</p>
<div class="section" id="independent-component-analysis-ica">
<h2>Independent Component Analysis (ICA)<a class="headerlink" href="#independent-component-analysis-ica" title="Permalink to this headline">¶</a></h2>
<p>ICA finds directions in the feature space
corresponding to projections with high non-Gaussianity. We thus obtain
a decomposition into independent components, and the artifact’s contribution is
localized in only a small number of components.
These components have to be correctly identified and removed.</p>
<p>If EOG or ECG recordings are available, they can be used in ICA to automatically
select the corresponding artifact components from the decomposition. To do so,
you have to first build an Epoch object around blink or heartbeat event:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create an Epoch object from heartbeat events</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ecg_epochs</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">preprocessing</span><span class="o">.</span><span class="n">create_ecg_epochs</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span>
</pre></div>
</div>
<p>Then you need to create an ICA estimator and fit it on the data:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Initialize the ICA estimator and fit it on the data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ica</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">preprocessing</span><span class="o">.</span><span class="n">ICA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;fastica&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ica</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">raw</span><span class="p">,</span> <span class="n">picks</span><span class="o">=</span><span class="n">picks</span><span class="p">)</span>
</pre></div>
</div>
<p>Then you have to call the <code class="xref py py-func docutils literal"><span class="pre">ICA.find_bads_ecg()</span></code> function. It will
compute a score that quantify how much the Epoch is correlated to each independent
component, and select the components with the best scores. Then you just have to
exclude the components with func:<cite>ICA.exclude</cite>:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Find components highy correlated with heartbeat events</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ecg_inds</span><span class="p">,</span> <span class="n">scores</span> <span class="o">=</span> <span class="n">ica</span><span class="o">.</span><span class="n">find_bads_ecg</span><span class="p">(</span><span class="n">ecg_epochs</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;ctps&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Here we remove only 3 components</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ica</span><span class="o">.</span><span class="n">exclude</span> <span class="o">+=</span> <span class="n">ecg_inds</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
<div class="figure">
<a class="reference external image-reference" href="../../auto_tutorials/plot_ica_from_raw.html"><img alt="tutorials/preprocessing/../../../../_images/sphx_glr_plot_ica_from_raw_005.png" src="tutorials/preprocessing/../../../../_images/sphx_glr_plot_ica_from_raw_005.png" /></a>
</div>
<div class="topic">
<p class="topic-title first">Examples:</p>
<ul class="simple">
<li><a class="reference internal" href="../../auto_tutorials/plot_ica_from_raw.html#sphx-glr-auto-tutorials-plot-ica-from-raw-py"><span>Compute ICA on MEG data and remove artifacts</span></a></li>
<li><a class="reference internal" href="../../auto_examples/preprocessing/plot_find_ecg_artifacts.html#sphx-glr-auto-examples-preprocessing-plot-find-ecg-artifacts-py"><span>Find ECG artifacts</span></a></li>
<li><a class="reference internal" href="../../auto_examples/preprocessing/plot_find_eog_artifacts.html#sphx-glr-auto-examples-preprocessing-plot-find-eog-artifacts-py"><span>Find EOG artifacts</span></a></li>
<li><a class="reference internal" href="../../auto_examples/preprocessing/plot_eog_artifact_histogram.html#sphx-glr-auto-examples-preprocessing-plot-eog-artifact-histogram-py"><span>Show EOG artifact timing</span></a></li>
</ul>
</div>
<p>If EOG or ECG recordings are not available, you can visually select the artifact
components. This can be done on the independent components time series or on the independent
components spatial distribution, looking for
the characteristic shapes of blinks and heartbeats artifacts:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
<p>You can also use this manual identification on one subject in order to automatically
find corresponding components in other subject, using
<code class="xref py py-func docutils literal"><span class="pre">CORRMAP</span></code>
(See <a class="reference internal" href="../../auto_examples/preprocessing/plot_corrmap_detection.html#sphx-glr-auto-examples-preprocessing-plot-corrmap-detection-py"><span>Identify similar ICs across multiple datasets via CORRMAP</span></a> for
a detailed example of using CORRMAP).</p>
<div class="topic">
<p class="topic-title first">Examples:</p>
<ul class="simple">
<li><a class="reference internal" href="../../auto_examples/preprocessing/plot_corrmap_detection.html#sphx-glr-auto-examples-preprocessing-plot-corrmap-detection-py"><span>Identify similar ICs across multiple datasets via CORRMAP</span></a></li>
<li><a class="reference internal" href="../../auto_examples/preprocessing/plot_run_ica.html#sphx-glr-auto-examples-preprocessing-plot-run-ica-py"><span>Compute ICA components on epochs</span></a></li>
</ul>
</div>
<p>ICA-based artifact rejection is done using the <a class="reference internal" href="../../generated/mne.preprocessing.ICA.html#mne.preprocessing.ICA" title="mne.preprocessing.ICA"><code class="xref py py-class docutils literal"><span class="pre">mne.preprocessing.ICA</span></code></a>
class, see the <a class="reference internal" href="../../manual/preprocessing/ica.html#ica"><span>Independent Component Analysis (ICA)</span></a> section in the manual for more
information on ICA&#8217;s concepts.</p>
</div>
<div class="section" id="signal-space-projection-ssp">
<h2>Signal-Space Projection (SSP)<a class="headerlink" href="#signal-space-projection-ssp" title="Permalink to this headline">¶</a></h2>
<p>Instead of using ICA, you can also use Signal-Space Projection (SSP) to extract artifacts.
SSP-based rejection is done using the
<a class="reference internal" href="../../generated/mne.preprocessing.compute_proj_ecg.html#mne.preprocessing.compute_proj_ecg" title="mne.preprocessing.compute_proj_ecg"><code class="xref py py-func docutils literal"><span class="pre">compute_proj_ecg</span></code></a> and
<a class="reference internal" href="../../generated/mne.preprocessing.compute_proj_eog.html#mne.preprocessing.compute_proj_eog" title="mne.preprocessing.compute_proj_eog"><code class="xref py py-func docutils literal"><span class="pre">compute_proj_eog</span></code></a> methods,
see <a class="reference internal" href="../../manual/preprocessing/ssp.html#ssp"><span>Projections</span></a> section in the manual for more information.
The commands look like:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ecg_proj</span><span class="p">,</span> <span class="n">ecg_event</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">preprocessing</span><span class="o">.</span><span class="n">compute_proj_ecg</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>


    </div>
    
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
      
    </p>
    <p>
        &copy; Copyright 2012-2016, MNE Developers.<br/>
    </p>
  </div>
</footer>
  </body>
</html>