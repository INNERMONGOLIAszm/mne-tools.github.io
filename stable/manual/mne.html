<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>The current estimates &mdash; MNE 0.9.0 documentation</title>
    
    <link rel="stylesheet" href="../_static/navy.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.9.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="MNE 0.9.0 documentation" href="../index.html" />
    <link rel="up" title="Manual" href="../manual.html" />
    <link rel="next" title="Interactive analysis" href="analyze.html" />
    <link rel="prev" title="The forward solution" href="forward.html" />

<link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,400,700' rel='stylesheet' type='text/css'>


    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-37225609-1']);
    _gaq.push(['_trackPageview']);

    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>



    <script type="text/javascript">
    !function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);
    js.id=id;js.src="http://platform.twitter.com/widgets.js";
    fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");
    </script>



    <script type="text/javascript">
    (function() {
    var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
    po.src = 'https://apis.google.com/js/plusone.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
    })();
    </script>


  </head>
  <body role="document">

<div style="background-color: white; text-align: left; padding: 10px 7px 15px 15px; min-width: 910px">
<div style="float: left">
<a href="../index.html"><img src="../_static/mne_logo.png" border="0" alt="py4sci"/></a>
</div>

<div style="float: right">
<a href="../index.html"><img src="../_static/institutions.png" border="0" alt="py4sci"/></a>
</div>
<br style="clear:both"/>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../np-modindex.html" title="Python Module Index"
             >modules</a></li>
        <li class="right" >
          <a href="analyze.html" title="Interactive analysis"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="forward.html" title="The forward solution"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">Home</a>&nbsp;|&nbsp;</li>
        <li><a href="../manual.html">Manual</a>&nbsp;|&nbsp;</li>
        <li><a href="../mne-python.html">Python</a>&nbsp;|&nbsp;</li>
        <li><a href="../cite.html">Cite MNE</a>&nbsp;|&nbsp;</li>
        <!-- <li><a href="../search.html">Search</a></li> -->

          <li class="nav-item nav-item-1"><a href="../manual.html" accesskey="U">Manual</a> &raquo;</li> 
      </ul>
    </div>

      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h3><a href="../index.html">Table Of Contents</a></h3>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../manual.html">Manual</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="list.html">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="cookbook.html">The Cookbook</a></li>
<li class="toctree-l2"><a class="reference internal" href="browse.html">Processing raw data</a></li>
<li class="toctree-l2"><a class="reference internal" href="forward.html">The forward solution</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">The current estimates</a></li>
<li class="toctree-l2"><a class="reference internal" href="analyze.html">Interactive analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="morph.html">Morphing and averaging</a></li>
<li class="toctree-l2"><a class="reference internal" href="convert.html">Data conversion</a></li>
<li class="toctree-l2"><a class="reference internal" href="matlab.html">The Matlab toolbox</a></li>
<li class="toctree-l2"><a class="reference internal" href="utilities.html">Miscellaneous utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="sampledata.html">The sample data set</a></li>
<li class="toctree-l2"><a class="reference internal" href="reading.html">Related publications</a></li>
<li class="toctree-l2"><a class="reference internal" href="AppA.html">Creating the BEM meshes</a></li>
<li class="toctree-l2"><a class="reference internal" href="AppB.html">Setup at the Martinos Center</a></li>
<li class="toctree-l2"><a class="reference internal" href="AppInstall.html">Installation and configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="AppReleaseNotes.html">Release notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="AppEULA.html">Licence agreement</a></li>
<li class="toctree-l2"><a class="reference internal" href="../command_line_tutorial.html">Getting started with MNE command line</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../mne-python.html">MNE with Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mne-cpp.html">MNE with CPP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cite.html">Cite MNE and MNE-Python</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script><h3>Versions</h3>
<ul class="current">
    <li class="toctree-l1"><a href=http://martinos.org/mne/stable>Stable</a></li>
    <li class="toctree-l1"><a href=http://martinos.org/mne/dev>Development</a></li>
</ul>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="the-current-estimates">
<span id="ch-mne"></span><h1>The current estimates<a class="headerlink" href="#the-current-estimates" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>This Chapter describes the computation of the minimum-norm
estimates. This is accomplished with two programs: <em>mne_inverse_operator</em> and <em>mne_make_movie</em>.
The chapter starts with a mathematical description of the method,
followed by description of the two software modules. The interactive
program for inspecting data and inverse solutions, mne_analyze ,
is covered in <a class="reference internal" href="analyze.html#ch-interactive-analysis"><span>Interactive analysis</span></a>.</p>
</div>
<div class="section" id="minimum-norm-estimates">
<span id="cbbdjfbj"></span><h2>Minimum-norm estimates<a class="headerlink" href="#minimum-norm-estimates" title="Permalink to this headline">¶</a></h2>
<p>This section describes the mathematical details of the calculation
of minimum-norm estimates. In Bayesian sense, the ensuing current
distribution is the maximum a posteriori (MAP) estimate under the
following assumptions:</p>
<ul class="simple">
<li>The viable locations of the currents
are constrained to the cortex. Optionally, the current orientations
can be fixed to be normal to the cortical mantle.</li>
<li>The amplitudes of the currents have a Gaussian prior distribution
with a known source covariance matrix.</li>
<li>The measured data contain additive noise with a Gaussian distribution with
a known covariance matrix. The noise is not correlated over time.</li>
</ul>
<div class="section" id="the-linear-inverse-operator">
<h3>The linear inverse operator<a class="headerlink" href="#the-linear-inverse-operator" title="Permalink to this headline">¶</a></h3>
<p>The measured data in the source estimation procedure consists
of MEG and EEG data, recorded on a total of N channels. The task
is to estimate a total of M strengths of sources located on the
cortical mantle. If the number of source locations is P, M = P for
fixed-orientation sources and M = 3P if the source orientations
are unconstrained. The regularized linear inverse operator following
from the Bayesian approach is given by the <span class="math">M \times N</span> matrix</p>
<div class="math">
<p><span class="math">M = R' G^T (G R' G^T + C)^{-1}\ ,</span></p>
</div><p>where G is the gain matrix relating the source strengths
to the measured MEG/EEG data, <span class="math">C</span> is the data noise-covariance matrix
and <span class="math">R'</span> is the source covariance matrix.
The dimensions of these matrices are <span class="math">N \times M</span>, <span class="math">N \times N</span>,
and <span class="math">M \times M</span>, respectively. The <span class="math">M \times 1</span> source-strength
vector is obtained by multiplying the <span class="math">N \times 1</span> data
vector by <span class="math">M</span>.</p>
<p>The expected value of the current amplitudes at time <em>t</em> is
then given by <span class="math">\hat{j}(t) = Mx(t)</span>, where <span class="math">x(t)</span> is
a vector containing the measured MEG and EEG data values at time <em>t</em>.</p>
</div>
<div class="section" id="regularization">
<span id="cbbhaajj"></span><h3>Regularization<a class="headerlink" href="#regularization" title="Permalink to this headline">¶</a></h3>
<p>The a priori variance of the currents is, in practise, unknown.
We can express this by writing <span class="math">R' = R/ \lambda^2</span>,
which yields the inverse operator</p>
<div class="math">
<p><span class="math">M = R G^T (G R G^T + \lambda^2 C)^{-1}\ ,</span></p>
</div><p>where the unknown current amplitude is now interpreted in
terms of the regularization parameter <span class="math">\lambda^2</span>.
Small <span class="math">\lambda^2</span> corresponds to large current amplitudes
and complex estimate current patterns while a large <span class="math">\lambda^2</span> means the
amplitude of the current is limited and a simpler, smooth, current
estimate is obtained.</p>
<p>We can arrive in the regularized linear inverse operator
also by minimizing the cost function</p>
<div class="math">
<p><span class="math">S = \tilde{e}^T \tilde{e} + \lambda^2 j^T R^{-1} j\ ,</span></p>
</div><p>where the first term consists of the difference between the
whitened measured data (see <a class="reference internal" href="#chddhage"><span>Whitening and scaling</span></a>) and those predicted
by the model while the second term is a weighted-norm of the current
estimate. It is seen that, with increasing <span class="math">\lambda^2</span>,
the source term receive more weight and larger discrepancy between
the measured and predicted data is tolerable.</p>
</div>
<div class="section" id="whitening-and-scaling">
<span id="chddhage"></span><h3>Whitening and scaling<a class="headerlink" href="#whitening-and-scaling" title="Permalink to this headline">¶</a></h3>
<p>The MNE software employs data whitening so that a &#8216;whitened&#8217; inverse operator
assumes the form</p>
<div class="math">
<p><span class="math">\tilde{M} = R \tilde{G}^T (\tilde{G} R \tilde{G}^T + I)^{-1}\ ,</span></p>
</div><p>where <span class="math">\tilde{G} = C^{-^1/_2}G</span> is the spatially
whitened gain matrix. The expected current values are <span class="math">\hat{j} = Mx(t)</span>,
where <span class="math">x(t) = C^{-^1/_2}x(t)</span> is a the whitened measurement
vector at <em>t</em>. The spatial whitening operator
is obtained with the help of the eigenvalue decomposition <span class="math">C = U_C \Lambda_C^2 U_C^T</span> as <span class="math">C^{-^1/_2} = \Lambda_C^{-1} U_C^T</span>.
In the MNE software the noise-covariance matrix is stored as the
one applying to raw data. To reflect the decrease of noise due to
averaging, this matrix, <span class="math">C_0</span>, is scaled
by the number of averages, <span class="math">L</span>, <em>i.e.</em>, <span class="math">C = C_0 / L</span>.</p>
<p>As shown above, regularization of the inverse solution is
equivalent to a change in the variance of the current amplitudes
in the Bayesian <em>a priori</em> distribution.</p>
<p>Convenient choice for the source-covariance matrix <span class="math">R</span> is
such that <span class="math">\text{trace}(\tilde{G} R \tilde{G}^T) / \text{trace}(I) = 1</span>. With this choice we
can approximate <span class="math">\lambda^2 \sim 1/SNR</span>, where SNR is
the (power) signal-to-noise ratio of the whitened data.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The definition of the signal to noise-ratio/ <span class="math">\lambda^2</span> relationship    given above works nicely for the whitened forward solution. In the    un-whitened case scaling with the trace ratio <span class="math">\text{trace}(GRG^T) / \text{trace}(C)</span> does not make sense, since the diagonal elements summed have, in general,    different units of measure. For example, the MEG data are expressed    in T or T/m whereas the unit of EEG is Volts.</p>
</div>
</div>
<div class="section" id="regularization-of-the-noise-covariance-matrix">
<span id="cbbhegab"></span><h3>Regularization of the noise-covariance matrix<a class="headerlink" href="#regularization-of-the-noise-covariance-matrix" title="Permalink to this headline">¶</a></h3>
<p>Since finite amount of data is usually available to compute
an estimate of the noise-covariance matrix <span class="math">C</span>,
the smallest eigenvalues of its estimate are usually inaccurate
and smaller than the true eigenvalues. Depending on the seriousness
of this problem, the following quantities can be affected:</p>
<ul class="simple">
<li>The model data predicted by the current
estimate,</li>
<li>Estimates of signal-to-noise ratios, which lead to estimates
of the required regularization, see <a class="reference internal" href="#cbbhaajj"><span>Regularization</span></a>,</li>
<li>The estimated current values, and</li>
<li>The noise-normalized estimates, see <a class="reference internal" href="#cbbeaich"><span>Noise normalization</span></a>.</li>
</ul>
<p>Fortunately, the latter two are least likely to be affected
due to regularization of the estimates. However, in some cases especially
the EEG part of the noise-covariance matrix estimate can be deficient, <em>i.e.</em>,
it may possess very small eigenvalues and thus regularization of
the noise-covariance matrix is advisable.</p>
<p>The MNE software accomplishes the regularization by replacing
a noise-covariance matrix estimate <span class="math">C</span> with</p>
<div class="math">
<p><span class="math">C' = C + \sum_k {\varepsilon_k \bar{\sigma_k}^2 I^{(k)}}\ ,</span></p>
</div><p>where the index <span class="math">k</span> goes across
the different channel groups (MEG planar gradiometers, MEG axial
gradiometers and magnetometers, and EEG), <span class="math">\varepsilon_k</span> are
the corresponding regularization factors, <span class="math">\bar{\sigma_k}</span> are
the average variances across the channel groups, and <span class="math">I^{(k)}</span> are
diagonal matrices containing ones at the positions corresponding
to the channels contained in each channel group. The values <span class="math">\varepsilon_k</span> can
be adjusted with the regularization options <code class="docutils literal"><span class="pre">--magreg</span></code> , <code class="docutils literal"><span class="pre">--gradreg</span></code> ,
and <code class="docutils literal"><span class="pre">--eegreg</span></code> specified at the time of the inverse operator
decomposition, see <a class="reference internal" href="#cbbddbgf"><span>Inverse-operator decomposition</span></a>. The convenience script mne_do_inverse_solution has
the <code class="docutils literal"><span class="pre">--magreg</span></code> and <code class="docutils literal"><span class="pre">--gradreg</span></code> combined to
a single option, <code class="docutils literal"><span class="pre">--megreg</span></code> , see <a class="reference internal" href="cookbook.html#cihcfjei"><span>Calculating the inverse operator decomposition</span></a>.
Suggested range of values for <span class="math">\varepsilon_k</span> is <span class="math">0.05 \dotso 0.2</span>.</p>
</div>
<div class="section" id="computation-of-the-solution">
<span id="chdbehbc"></span><h3>Computation of the solution<a class="headerlink" href="#computation-of-the-solution" title="Permalink to this headline">¶</a></h3>
<p>The most straightforward approach to calculate the MNE is
to employ expression for the original or whitened inverse operator
directly. However, for computational convenience we prefer to take
another route, which employs the singular-value decomposition (SVD)
of the matrix</p>
<div class="math">
<p><span class="math">A = \tilde{G} R^{^1/_2} = U \Lambda V^T</span></p>
</div><p>where the superscript <span class="math">^1/_2</span> indicates a
square root of <span class="math">R</span>. For a diagonal matrix,
one simply takes the square root of <span class="math">R</span> while
in the more general case one can use the Cholesky factorization <span class="math">R = R_C R_C^T</span> and
thus <span class="math">R^{^1/_2} = R_C</span>.</p>
<p>With the above SVD it is easy to show that</p>
<div class="math">
<p><span class="math">\tilde{M} = R^{^1/_2} V \Gamma U^T</span></p>
</div><p>where the elements of the diagonal matrix <span class="math">\Gamma</span> are</p>
<div class="math">
<p><span class="math">\gamma_k = \frac{1}{\lambda_k} \frac{\lambda_k^2}{\lambda_k^2 + \lambda^2}\ .</span></p>
</div><p>With <span class="math">w(t) = U^T C^{-^1/_2} x(t)</span> the expression for
the expected current is</p>
<div class="math">
<p><span class="math">\hat{j}(t) = R^C V \Gamma w(t) = \sum_k {\bar{v_k} \gamma_k w_k(t)}\ ,</span></p>
</div><p>where <span class="math">\bar{v_k} = R^C v_k</span>, <span class="math">v_k</span> being
the <span class="math">k</span> th column of <span class="math">V</span>. It is thus seen that the current estimate is
a weighted sum of the &#8216;modified&#8217; eigenleads <span class="math">v_k</span>.</p>
<p>It is easy to see that <span class="math">w(t) \propto \sqrt{L}</span>.
To maintain the relation <span class="math">(\tilde{G} R \tilde{G}^T) / \text{trace}(I) = 1</span> when <span class="math">L</span> changes
we must have <span class="math">R \propto 1/L</span>. With this approach, <span class="math">\lambda_k</span> is
independent of  <span class="math">L</span> and, for fixed <span class="math">\lambda</span>,
we see directly that <span class="math">j(t)</span> is independent
of <span class="math">L</span>.</p>
</div>
<div class="section" id="noise-normalization">
<span id="cbbeaich"></span><h3>Noise normalization<a class="headerlink" href="#noise-normalization" title="Permalink to this headline">¶</a></h3>
<p>The noise-normalized linear estimates introduced by Dale
et al. require division of the expected current amplitude by its
variance. Noise normalization serves three purposes:</p>
<ul class="simple">
<li>It converts the expected current value
into a dimensionless statistical test variable. Thus the resulting
time and location dependent values are often referred to as dynamic
statistical parameter maps (dSPM).</li>
<li>It reduces the location bias of the estimates. In particular,
the tendency of the MNE to prefer superficial currents is eliminated.</li>
<li>The width of the point-spread function becomes less dependent
on the source location on the cortical mantle. The point-spread
is defined as the MNE resulting from the signals coming from a point
current source (a current dipole) located at a certain point on
the cortex.</li>
</ul>
<p>In practice, noise normalization requires the computation
of the diagonal elements of the matrix</p>
<div class="math">
<p><span class="math">M C M^T = \tilde{M} \tilde{M}^T\ .</span></p>
</div><p>With help of the singular-value decomposition approach we
see directly that</p>
<div class="math">
<p><span class="math">\tilde{M} \tilde{M}^T\ = \bar{V} \Gamma^2 \bar{V}^T\ .</span></p>
</div><p>Under the conditions expressed at the end of <a class="reference internal" href="#chdbehbc"><span>Computation of the solution</span></a>, it follows that the <em>t</em>-statistic values associated
with fixed-orientation sources) are thus proportional to <span class="math">\sqrt{L}</span> while
the <em>F</em>-statistic employed with free-orientation sources is proportional
to <span class="math">L</span>, correspondingly.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">A section discussing statistical considerations    related to the noise normalization procedure will be added to this    manual in one of the subsequent releases.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The MNE software usually computes the square    roots of the F-statistic to be displayed on the inflated cortical    surfaces. These are also proportional to <span class="math">\sqrt{L}</span>.</p>
</div>
</div>
<div class="section" id="predicted-data">
<span id="chdcacdc"></span><h3>Predicted data<a class="headerlink" href="#predicted-data" title="Permalink to this headline">¶</a></h3>
<p>Under noiseless conditions the SNR is infinite and thus leads
to <span class="math">\lambda^2 = 0</span> and the minimum-norm estimate
explains the measured data perfectly. Under realistic conditions,
however, <span class="math">\lambda^2 &gt; 0</span> and there is a misfit
between measured data and those predicted by the MNE. Comparison
of the predicted data, here denoted by <span class="math">x(t)</span>,
and measured one can give valuable insight on the correctness of
the regularization applied.</p>
<p>In the SVD approach we easily find</p>
<div class="math">
<p><span class="math">\hat{x}(t) = G \hat{j}(t) = C^{^1/_2} U \Pi w(t)\ ,</span></p>
</div><p>where the diagonal matrix <span class="math">\Pi</span> has
elements <span class="math">\pi_k = \lambda_k \gamma_k</span> The predicted data is
thus expressed as the weighted sum of the &#8216;recolored eigenfields&#8217; in <span class="math">C^{^1/_2} U</span>.</p>
</div>
<div class="section" id="cortical-patch-statistics">
<span id="cbbdbhdi"></span><h3>Cortical patch statistics<a class="headerlink" href="#cortical-patch-statistics" title="Permalink to this headline">¶</a></h3>
<p>If the <code class="docutils literal"><span class="pre">--cps</span></code> option was used in source space
creation (see <a class="reference internal" href="cookbook.html#cihchdae"><span>Setting up the source space</span></a>) or if mne_add_patch_info described
in <a class="reference internal" href="utilities.html#behcbcgg"><span>Adding neighborhood/topology information to source spaces</span></a> was run manually the source space file
will contain for each vertex of the cortical surface the information
about the source space point closest to it as well as the distance
from the vertex to this source space point. The vertices for which
a given source space point is the nearest one define the cortical
patch associated with with the source space point. Once these data
are available, it is straightforward to compute the following cortical
patch statistics (CPS) for each source location <span class="math">d</span>:</p>
<ul class="simple">
<li>The average over the normals of at the
vertices in a patch, <span class="math">\bar{n_d}</span>,</li>
<li>The areas of the patches, <span class="math">A_d</span>,
and</li>
<li>The average deviation of the vertex normals in a patch from
their average, <span class="math">\sigma_d</span>, given in degrees.</li>
</ul>
</div>
<div class="section" id="the-orientation-constraints">
<h3>The orientation constraints<a class="headerlink" href="#the-orientation-constraints" title="Permalink to this headline">¶</a></h3>
<p>The principal sources of MEG and EEG signals are generally
believed to be postsynaptic currents in the cortical pyramidal neurons.
Since the net primary current associated with these microscopic
events is oriented normal to the cortical mantle, it is reasonable
to use the cortical normal orientation as a constraint in source
estimation. In addition to allowing completely free source orientations,
the MNE software implements three orientation constraints based
of the surface normal data:</p>
<ul class="simple">
<li>Source orientation can be rigidly fixed
to the surface normal direction (the <code class="docutils literal"><span class="pre">--fixed</span></code> option).
If cortical patch statistics are available the average normal over
each patch, <span class="math">\bar{n_d}</span>, are used to define
the source orientation. Otherwise, the vertex normal at the source
space location is employed.</li>
<li>A <em>location independent or fixed loose orientation
constraint</em> (fLOC) can be employed (the <code class="docutils literal"><span class="pre">--loose</span></code> option).
In this approach, a source coordinate system based on the local
surface orientation at the source location is employed. By default,
the three columns of the gain matrix G, associated with a given
source location, are the fields of unit dipoles pointing to the
directions of the x, y, and z axis of the coordinate system employed
in the forward calculation (usually the MEG head coordinate frame).
For LOC the orientation is changed so that the first two source
components lie in the plane normal to the surface normal at the source
location and the third component is aligned with it. Thereafter, the
variance of the source components tangential to the cortical surface are
reduced by a factor defined by the <code class="docutils literal"><span class="pre">--loose</span></code> option.</li>
<li>A <em>variable loose orientation constraint</em> (vLOC)
can be employed (the <code class="docutils literal"><span class="pre">--loosevar</span></code> option). This is similar
to fLOC except that the value given with the <code class="docutils literal"><span class="pre">--loosevar</span></code> option
will be multiplied by <span class="math">\sigma_d</span>, defined above.</li>
</ul>
</div>
<div class="section" id="depth-weighting">
<span id="cbbdfjie"></span><h3>Depth weighting<a class="headerlink" href="#depth-weighting" title="Permalink to this headline">¶</a></h3>
<p>The minimum-norm estimates have a bias towards superficial
currents. This tendency can be alleviated by adjusting the source
covariance matrix <span class="math">R</span> to favor deeper source locations. In the depth
weighting scheme employed in MNE analyze, the elements of <span class="math">R</span> corresponding
to the <span class="math">p</span> th source location are be
scaled by a factor</p>
<div class="math">
<p><span class="math">f_p = (g_{1p}^T g_{1p} + g_{2p}^T g_{2p} + g_{3p}^T g_{3p})^{-\gamma}\ ,</span></p>
</div><p>where <span class="math">g_{1p}</span>, <span class="math">g_{2p}</span>, and <span class="math">g_{3p}</span> are the three columns
of <span class="math">G</span> corresponding to source location <span class="math">p</span> and <span class="math">\gamma</span> is
the order of the depth weighting, specified with the <code class="docutils literal"><span class="pre">--weightexp</span></code> option
to mne_inverse_operator . The
maximal amount of depth weighting can be adjusted <code class="docutils literal"><span class="pre">--weightlimit</span></code> option.</p>
</div>
<div class="section" id="fmri-guided-estimates">
<span id="cbbdijhi"></span><h3>fMRI-guided estimates<a class="headerlink" href="#fmri-guided-estimates" title="Permalink to this headline">¶</a></h3>
<p>The fMRI weighting in MNE software means that the source-covariance matrix
is modified to favor areas of significant fMRI activation. For this purpose,
the fMRI activation map is thresholded first at the value defined by
the <code class="docutils literal"><span class="pre">--fmrithresh</span></code> option to mne_do_inverse_operator or mne_inverse_operator .
Thereafter, the source-covariance matrix values corresponding to
the the sites under the threshold are multiplied by <span class="math">f_{off}</span>, set
by the <code class="docutils literal"><span class="pre">--fmrioff</span></code> option.</p>
<p>It turns out that the fMRI weighting has a strong influence
on the MNE but the noise-normalized estimates are much less affected
by it.</p>
</div>
</div>
<div class="section" id="effective-number-of-averages">
<span id="cbbdgiae"></span><h2>Effective number of averages<a class="headerlink" href="#effective-number-of-averages" title="Permalink to this headline">¶</a></h2>
<p>It is often the case that the epoch to be analyzed is a linear
combination over conditions rather than one of the original averages
computed. As stated above, the noise-covariance matrix computed
is originally one corresponding to raw data. Therefore, it has to
be scaled correctly to correspond to the actual or effective number
of epochs in the condition to be analyzed. In general, we have</p>
<div class="math">
<p><span class="math">C = C_0 / L_{eff}</span></p>
</div><p>where <span class="math">L_{eff}</span> is the effective
number of averages. To calculate <span class="math">L_{eff}</span> for
an arbitrary linear combination of conditions</p>
<div class="math">
<p><span class="math">y(t) = \sum_{i = 1}^n {w_i x_i(t)}</span></p>
</div><p>we make use of the the fact that the noise-covariance matrix</p>
<div class="math">
<p><span class="math">C_y = \sum_{i = 1}^n {w_i^2 C_{x_i}} = C_0 \sum_{i = 1}^n {w_i^2 / L_i}</span></p>
</div><p>which leads to</p>
<div class="math">
<p><span class="math">1 / L_{eff} = \sum_{i = 1}^n {w_i^2 / L_i}</span></p>
</div><p>An important special case  of the above is a weighted average,
where</p>
<div class="math">
<p><span class="math">w_i = L_i / \sum_{i = 1}^n {L_i}</span></p>
</div><p>and, therefore</p>
<div class="math">
<p><span class="math">L_{eff} = \sum_{i = 1}^n {L_i}</span></p>
</div><p>Instead of a weighted average, one often computes a weighted
sum, a simplest case being a difference or sum of two categories.
For a difference <span class="math">w_1 = 1</span> and <span class="math">w_2 = -1</span> and
thus</p>
<div class="math">
<p><span class="math">1 / L_{eff} = 1 / L_1 + 1 / L_2</span></p>
</div><p>or</p>
<div class="math">
<p><span class="math">L_{eff} = \frac{L_1 L_2}{L_1 + L_2}</span></p>
</div><p>Interestingly, the same holds for a sum, where <span class="math">w_1 = w_2 = 1</span>.
Generalizing, for any combination of sums and differences, where <span class="math">w_i = 1</span> or <span class="math">w_i = -1</span>, <span class="math">i = 1 \dotso n</span>,
we have</p>
<div class="math">
<p><span class="math">1 / L_{eff} = \sum_{i = 1}^n {1/{L_i}}</span></p>
</div></div>
<div class="section" id="inverse-operator-decomposition">
<span id="cbbddbgf"></span><h2>Inverse-operator decomposition<a class="headerlink" href="#inverse-operator-decomposition" title="Permalink to this headline">¶</a></h2>
<p>The program <code class="docutils literal"><span class="pre">mne_inverse_operator</span></code> calculates
the decomposition <span class="math">A = \tilde{G} R^C = U \Lambda \bar{V^T}</span>, described in <a class="reference internal" href="#chdbehbc"><span>Computation of the solution</span></a>. It is normally invoked from the convenience
script <code class="docutils literal"><span class="pre">mne_do_inverse_operator</span></code> . This section describes
the options to <code class="docutils literal"><span class="pre">mne_inverse_operator</span></code> should a user need
to invoke it directly for special-purpose processing.</p>
<p>The command-line options of <code class="docutils literal"><span class="pre">mne_inverse_operator</span></code> are:</p>
<p><strong>&#8212;version</strong></p>
<blockquote>
<div>Show the program version and compilation date.</div></blockquote>
<p><strong>&#8212;help</strong></p>
<blockquote>
<div>List the command-line options.</div></blockquote>
<p><strong>&#8212;meg</strong></p>
<blockquote>
<div>Employ MEG data in the calculation of the estimates.</div></blockquote>
<p><strong>&#8212;eeg</strong></p>
<blockquote>
<div>Employ EEG data in the calculation of the estimates. Note: The EEG
computations have not been thoroughly tested at this time.</div></blockquote>
<p><strong>&#8212;fixed</strong></p>
<blockquote>
<div>Use fixed source orientations normal to the cortical mantle. By default,
the source orientations are not constrained.</div></blockquote>
<p><strong>&#8212;loose &lt;*amount*&gt;</strong></p>
<blockquote>
<div>Employ a loose orientation constraint (LOC). This means that the source
covariance matrix entries corresponding to the current component
normal to the cortex are set equal to one and the transverse components
are set to &lt;<em>amount</em>&gt; . Recommended
value of amount is 0.2...0.6.</div></blockquote>
<p><strong>&#8212;loosevar &lt;*amount*&gt;</strong></p>
<blockquote>
<div>Use an adaptive loose orientation constraint. This option can be
only employed if the source spaces included in the forward solution
have the patch information computed, see <a class="reference internal" href="cookbook.html#cihchdae"><span>Setting up the source space</span></a>. Blaa
blaa...***what???**</div></blockquote>
<p><strong>&#8212;fwd &lt;*name*&gt;</strong></p>
<blockquote>
<div>Specifies the name of the forward solution to use.</div></blockquote>
<p><strong>&#8212;noisecov &lt;*name*&gt;</strong></p>
<blockquote>
<div>Specifies the name of the noise-covariance matrix to use. If this
file contains a projection operator, attached by mne_browse_raw and mne_process_raw ,
no additional projection vectors can be added with the <code class="docutils literal"><span class="pre">--proj</span></code> option. For
backward compatibility, <code class="docutils literal"><span class="pre">--senscov</span></code> can be used as a synonym for <code class="docutils literal"><span class="pre">--noisecov</span></code>.</div></blockquote>
<p><strong>&#8212;noiserank &lt;*value*&gt;</strong></p>
<blockquote>
<div>Specifies the rank of the noise covariance matrix explicitly rather than
trying to reduce it automatically. This option is seldom needed,</div></blockquote>
<p><strong>&#8212;gradreg &lt;*value*&gt;</strong></p>
<blockquote>
<div>Regularize the planar gradiometer section (channels for which the unit
of measurement is T/m) of the noise-covariance matrix by the given
amount. The value is restricted to the range 0...1. For details, see <a class="reference internal" href="#cbbhegab"><span>Regularization of the noise-covariance matrix</span></a>.</div></blockquote>
<p><strong>&#8212;magreg &lt;*value*&gt;</strong></p>
<blockquote>
<div>Regularize the magnetometer and axial gradiometer section (channels
for which the unit of measurement is T) of the noise-covariance matrix
by the given amount. The value is restricted to the range 0...1.
For details, see <a class="reference internal" href="#cbbhegab"><span>Regularization of the noise-covariance matrix</span></a>.</div></blockquote>
<p><strong>&#8212;eegreg &lt;*value*&gt;</strong></p>
<blockquote>
<div>Regularize the EEG section of the noise-covariance matrix by the given
amount. The value is restricted to the range 0...1. For details, see <a class="reference internal" href="#cbbhegab"><span>Regularization of the noise-covariance matrix</span></a>.</div></blockquote>
<p><strong>&#8212;diagnoise</strong></p>
<blockquote>
<div>Omit the off-diagonal terms from the noise-covariance matrix in
the computations. This may be useful if the amount of signal-free
data has been insufficient to calculate a reliable estimate of the
full noise-covariance matrix.</div></blockquote>
<p><strong>&#8212;srccov &lt;*name*&gt;</strong></p>
<blockquote>
<div>Specifies the name of the diagonal source-covariance matrix to use.
By default the source covariance matrix is a multiple of the identity matrix.
This option can be employed to incorporate the fMRI constraint.
The software to create a source-covariance matrix file from fMRI
data will be provided in a future release of this software package.</div></blockquote>
<p><strong>&#8212;depth</strong></p>
<blockquote>
<div>Employ depth weighting. For details, see <a class="reference internal" href="#cbbdfjie"><span>Depth weighting</span></a>.</div></blockquote>
<p><strong>&#8212;weightexp &lt;*value*&gt;</strong></p>
<blockquote>
<div>This parameter determines the steepness of the depth weighting function
(default = 0.8). For details, see <a class="reference internal" href="#cbbdfjie"><span>Depth weighting</span></a>.</div></blockquote>
<p><strong>&#8212;weightlimit &lt;*value*&gt;</strong></p>
<blockquote>
<div>Maximum relative strength of the depth weighting (default = 10). For
details, see <a class="reference internal" href="#cbbdfjie"><span>Depth weighting</span></a>.</div></blockquote>
<p><strong>&#8212;fmri &lt;*name*&gt;</strong></p>
<blockquote>
<div>With help of this w file, an <em>a priori</em> weighting
can be applied to the source covariance matrix. The source of the
weighting is usually fMRI but may be also some other data, provided
that the weighting  can be expressed as a scalar value on the cortical
surface, stored in a w file. It is recommended that this w file
is appropriately smoothed (see <a class="reference internal" href="morph.html#chdebahh"><span>About smoothing</span></a>) in mne_analyze , tksurfer or
with mne_smooth_w to contain
nonzero values at all vertices of the triangular tessellation of
the cortical surface. The name of the file given is used as a stem of
the w files. The actual files should be called &lt;<em>name</em>&gt; <code class="docutils literal"><span class="pre">-lh.pri</span></code> and &lt;<em>name</em>&gt; <code class="docutils literal"><span class="pre">-rh.pri</span></code> for
the left and right hemsphere weight files, respectively. The application
of the weighting is discussed in <a class="reference internal" href="#cbbdijhi"><span>fMRI-guided estimates</span></a>.</div></blockquote>
<p><strong>&#8212;fmrithresh &lt;*value*&gt;</strong></p>
<blockquote>
<div>This option is mandatory and has an effect only if a weighting function
has been specified with the <code class="docutils literal"><span class="pre">--fmri</span></code> option. If the value
is in the <em>a priori</em> files falls below this value
at a particular source space point, the source covariance matrix
values are multiplied by the value specified with the <code class="docutils literal"><span class="pre">--fmrioff</span></code> option
(default 0.1). Otherwise it is left unchanged.</div></blockquote>
<p><strong>&#8212;fmrioff &lt;*value*&gt;</strong></p>
<blockquote>
<div>The value by which the source covariance elements are multiplied
if the <em>a priori</em> weight falls below the threshold
set with <code class="docutils literal"><span class="pre">--fmrithresh</span></code> , see above.</div></blockquote>
<p><strong>&#8212;bad &lt;*name*&gt;</strong></p>
<blockquote>
<div>A text file to designate bad channels, listed one channel name on each
line of the file. If the noise-covariance matrix specified with the <code class="docutils literal"><span class="pre">--noisecov</span></code> option
contains projections, bad channel lists can be included only if
they specify all channels containing non-zero entries in a projection
vector. For example, bad channels can usually specify all magnetometers
or all gradiometers since the projection vectors for these channel
types are completely separate. Similarly, it is possible to include
MEG data only or EEG data only by using only one of <code class="docutils literal"><span class="pre">--meg</span></code> or <code class="docutils literal"><span class="pre">--eeg</span></code> options
since the projection vectors for MEG and EEG are always separate.</div></blockquote>
<p><strong>&#8212;surfsrc</strong></p>
<blockquote>
<div>Use a source coordinate system based on the local surface orientation
at the source location. By default, the three dipole components are
pointing to the directions of the x, y, and z axis of the coordinate system
employed in the forward calculation (usually the MEG head coordinate
frame). This option changes the orientation so that the first two
source components lie in the plane normal to the surface normal
at the source location and the third component is aligned with it.
If patch information is available in the source space, the normal
is the average patch normal, otherwise the vertex normal at the source
location is used. If the <code class="docutils literal"><span class="pre">--loose</span></code> or <code class="docutils literal"><span class="pre">--loosevar</span></code> option
is employed, <code class="docutils literal"><span class="pre">--surfsrc</span></code> is implied.</div></blockquote>
<p><strong>&#8212;exclude &lt;*name*&gt;</strong></p>
<blockquote>
<div>Exclude the source space points defined by the given FreeSurfer &#8216;label&#8217; file
from the source reconstruction. This is accomplished by setting
the corresponding entries in the source-covariance matrix equal
to zero. The name of the file should end with <code class="docutils literal"><span class="pre">-lh.label</span></code>
if it refers to the left hemisphere and with <code class="docutils literal"><span class="pre">-rh.label</span></code> if
it lists points in the right hemisphere, respectively.</div></blockquote>
<p><strong>&#8212;proj &lt;*name*&gt;</strong></p>
<blockquote>
<div>Include signal-space projection (SSP) information from this file. For information
on SSP, see <a class="reference internal" href="browse.html#cacchabi"><span>The Signal-Space Projection (SSP) method</span></a>. If the projections are present in
the noise-covariance matrix, the <code class="docutils literal"><span class="pre">--proj</span></code> option is
not allowed.</div></blockquote>
<p><strong>&#8212;csd</strong></p>
<blockquote>
<div>Compute the inverse operator for surface current densities instead
of the dipole source amplitudes. This requires the computation of patch
statistics for the source space. Since this computation is time consuming,
it is recommended that the patch statistics are precomputed and
the source space file containing the patch information is employed
already when the forward solution is computed, see <a class="reference internal" href="cookbook.html#cihchdae"><span>Setting up the source space</span></a> and <a class="reference internal" href="cookbook.html#babchejd"><span>Computing the forward solution</span></a>.
For technical details of the patch information, please consult <a class="reference internal" href="#cbbdbhdi"><span>Cortical patch statistics</span></a>. This option is considered experimental at
the moment.</div></blockquote>
<p><strong>&#8212;inv &lt;*name*&gt;</strong></p>
<blockquote>
<div>Save the inverse operator decomposition here.</div></blockquote>
</div>
<div class="section" id="producing-movies-and-snapshots">
<span id="cbbecede"></span><h2>Producing movies and snapshots<a class="headerlink" href="#producing-movies-and-snapshots" title="Permalink to this headline">¶</a></h2>
<p>mne_make_movie is a program
for producing movies and snapshot graphics frames without any graphics
output to the screen. In addition, mne_make_movie can
produce stc or w files which contain the numerical current estimate
data in a simple binary format for postprocessing. These files can
be displayed in mne_analyze ,
see <a class="reference internal" href="analyze.html#ch-interactive-analysis"><span>Interactive analysis</span></a>, utilized in the cross-subject averaging
process, see <a class="reference internal" href="morph.html#ch-morph"><span>Morphing and averaging</span></a>, and read into Matlab using the MNE
Matlab toolbox, see <a class="reference internal" href="matlab.html#ch-matlab"><span>The Matlab toolbox</span></a>.</p>
<p>The command-line options to mne_make_movie are
explained in the following subsections.</p>
<div class="section" id="general-options">
<h3>General options<a class="headerlink" href="#general-options" title="Permalink to this headline">¶</a></h3>
<p><strong>&#8212;version</strong></p>
<blockquote>
<div>Show the program version and compilation date.</div></blockquote>
<p><strong>&#8212;help</strong></p>
<blockquote>
<div>List the command-line options.</div></blockquote>
</div>
<div class="section" id="input-files">
<h3>Input files<a class="headerlink" href="#input-files" title="Permalink to this headline">¶</a></h3>
<p><strong>&#8212;inv &lt;*name*&gt;</strong></p>
<blockquote>
<div>Load the inverse operator decomposition from here.</div></blockquote>
<p><strong>&#8212;meas &lt;*name*&gt;</strong></p>
<blockquote>
<div>Load the MEG or EEG data from this file.</div></blockquote>
<p><strong>&#8212;set &lt;*number*&gt;</strong></p>
<blockquote>
<div>The data set (condition) number to load. This is the sequential
number of the condition. You can easily see the association by looking
at the condition list in mne_analyze when
you load the file.</div></blockquote>
<p><strong>&#8212;stcin &lt;*name*&gt;</strong></p>
<blockquote>
<div>Specifies an stc file to read as input.</div></blockquote>
</div>
<div class="section" id="times-and-baseline">
<h3>Times and baseline<a class="headerlink" href="#times-and-baseline" title="Permalink to this headline">¶</a></h3>
<p><strong>&#8212;tmin &lt;*time/ms*&gt;</strong></p>
<blockquote>
<div>Specifies the starting time employed in the analysis. If <code class="docutils literal"><span class="pre">--tmin</span></code> option
is missing the analysis starts from the beginning of the epoch.</div></blockquote>
<p><strong>&#8212;tmax &lt;*time/ms*&gt;</strong></p>
<blockquote>
<div>Specifies the finishing time employed in the analysis. If <code class="docutils literal"><span class="pre">--tmax</span></code> option
is missing the analysis extends to the end of the epoch.</div></blockquote>
<p><strong>&#8212;tstep &lt;*step/ms*&gt;</strong></p>
<blockquote>
<div>Time step between consequtive movie frames, specified in milliseconds.</div></blockquote>
<p><strong>&#8212;integ  &lt;*:math:`Delta`t/ms*&gt;</strong></p>
<blockquote>
<div>Integration time for each frame. Defaults to zero. The integration will
be performed on sensor data. If the time specified for a frame is <span class="math">t_0</span>,
the integration range will be <span class="math">t_0 - \Delta t/2 \leq t \leq t_0 + \Delta t/2</span>.</div></blockquote>
<p><strong>&#8212;pick &lt;*time/ms*&gt;</strong></p>
<blockquote>
<div>Pick a time for the production of rgb, tif, jpg, png, or w files.
Several pick options may be present. The time must be with in the
analysis interval, indicated by the <code class="docutils literal"><span class="pre">--tmin</span></code> and <code class="docutils literal"><span class="pre">--tmax</span></code> options.
The <code class="docutils literal"><span class="pre">--rgb</span></code> , <code class="docutils literal"><span class="pre">--tif</span></code> , <code class="docutils literal"><span class="pre">--jpg</span></code> , <code class="docutils literal"><span class="pre">--png</span></code> , and <code class="docutils literal"><span class="pre">--w</span></code> options
control which file types are actually produced. When a <code class="docutils literal"><span class="pre">--pick</span></code> option
is encountered, the effect of any preceding <code class="docutils literal"><span class="pre">--pickrange</span></code> option
is ignored.</div></blockquote>
<p><strong>&#8212;pickrange</strong></p>
<blockquote>
<div>All previous <code class="docutils literal"><span class="pre">-pick</span></code> options will be ignored. Instead,
snapshots are produced as indicated by the <code class="docutils literal"><span class="pre">--tmin</span></code> , <code class="docutils literal"><span class="pre">--tmax</span></code> ,
and <code class="docutils literal"><span class="pre">--tstep</span></code> options. This is useful, <em>e.g.</em>,
for producing input for scripts merging the individual graphics
snapshots into a composite &#8220;filmstrip&#8221; reprensentation.
However, such scripts are not yet part of the MNE software.</div></blockquote>
<p><strong>&#8212;bmin &lt;*time/ms*&gt;</strong></p>
<blockquote>
<div>Specifies the starting time of the baseline. In order to activate
baseline correction, both <code class="docutils literal"><span class="pre">--bmin</span></code> and <code class="docutils literal"><span class="pre">--bmax</span></code> options
must be present.</div></blockquote>
<p><strong>&#8212;bmax &lt;*time/ms*&gt;</strong></p>
<blockquote>
<div>Specifies the finishing time of the baseline.</div></blockquote>
<p><strong>&#8212;baselines &lt;*file_name*&gt;</strong></p>
<blockquote>
<div>Specifies a file which contains the baseline settings. Each line
of the file should contain a name of a channel, followed by the
baseline value, separated from the channel name by a colon. The
baseline values must be specified in basic units, i.e., Teslas/meter
for gradiometers, Teslas for magnetometers, and Volts for EEG channels.
If some channels are missing from the baseline file, warning messages are
issued: for these channels, the <code class="docutils literal"><span class="pre">--bmin</span></code> and <code class="docutils literal"><span class="pre">--bmax</span></code> settings will
be used.</div></blockquote>
</div>
<div class="section" id="options-controlling-the-estimates">
<h3>Options controlling the estimates<a class="headerlink" href="#options-controlling-the-estimates" title="Permalink to this headline">¶</a></h3>
<p><strong>&#8212;nave &lt;*value*&gt;</strong></p>
<blockquote>
<div>Specifies the effective number of averaged epochs in the input data, <span class="math">L_{eff}</span>,
as discussed in <a class="reference internal" href="#cbbdgiae"><span>Effective number of averages</span></a>. If the input data file is
one produced by mne_browse_raw or mne_process_raw , the
number of averages is correct in the file. However, if subtractions
or some more complicated combinations of simple averages are produced,
e.g., by  using the xplotter software,
the number of averages should be manually adjusted along the guidelines
given in <a class="reference internal" href="#cbbdgiae"><span>Effective number of averages</span></a>. This is accomplished either by
employing this flag or by adjusting the number of averages in the
data file with help of the utility mne_change_nave .</div></blockquote>
<p><strong>&#8212;snr &lt;*value*&gt;</strong></p>
<blockquote>
<div>An estimate for the amplitude SNR. The regularization parameter will
be set as <span class="math">\lambda^2 = 1/SNR^2</span>. The default value is
SNR = 3. Automatic selection of the regularization parameter is
currently not supported.</div></blockquote>
<p><strong>&#8212;spm</strong></p>
<blockquote>
<div>Calculate the dSPM instead of the expected current value.</div></blockquote>
<p><strong>&#8212;sLORETA</strong></p>
<blockquote>
<div>Calculate the noise-normalized estimate using the sLORETA approach.
sLORETA solutions have in general a smaller location bias than either
the expected current (MNE) or the dSPM.</div></blockquote>
<p><strong>&#8212;signed</strong></p>
<blockquote>
<div>Indicate the current direction with respect to the cortex outer
normal by sign. Currents flowing out of the cortex are thus considered
positive (warm colors) and currents flowing into the cortex negative (cold
colors).</div></blockquote>
<p><strong>&#8212;picknormalcomp</strong></p>
<blockquote>
<div>The components of the estimates corresponding to directions tangential
with the cortical mantle are zeroed out.</div></blockquote>
</div>
<div class="section" id="visualization-options">
<span id="cbbbbhif"></span><h3>Visualization options<a class="headerlink" href="#visualization-options" title="Permalink to this headline">¶</a></h3>
<p><strong>&#8212;subject &lt;*subject*&gt;</strong></p>
<blockquote>
<div>Specifies the subject whose MRI data is employed in the visualization.
This must be the same subject that was used for computing the current
estimates. The environment variable SUBJECTS_DIR must be set to
point to a locations where the subjects are to be found.</div></blockquote>
<p><strong>&#8212;morph &lt;*subject*&gt;</strong></p>
<blockquote>
<div>Morph the data to to the cortical surface of another subject. The Quicktime
movie, stc-file, graphics snapshot, and w-file outputs are affected
by this option, <em>i.e.</em>, they will take the morphing
into account and will represent the data on the cortical surface
of the subject defined with this option. The stc files morphed to
a single subject&#8217;s cortical surface are used by mne_average_estimates to
combine data from different subjects, see <a class="reference internal" href="morph.html#chdfdife"><span>Averaging</span></a>.
If morphing is selected appropriate smoothing must be specified
with the <code class="docutils literal"><span class="pre">--smooth</span></code> option. The morphing process can
be made faster by precomputing the necessary morphing maps with mne_make_morph_maps ,
see <a class="reference internal" href="morph.html#chdbbhdh"><span>Precomputing the morphing maps</span></a>. More information about morphing and averaging
can be found in <a class="reference internal" href="morph.html#ch-morph"><span>Morphing and averaging</span></a>.</div></blockquote>
<p><strong>&#8212;morphgrade &lt;*number*&gt;</strong></p>
<blockquote>
<div>Adjusts the number of vertices in the stc files produced when morphing
is in effect. By default the number of vertices is 10242 corresponding
to &#8211;morphgrade value 5. Allowed values are 3, 4, 5, and 6 corresponding
to 642, 2562, 10242, and 40962 vertices, respectively.</div></blockquote>
<p><strong>&#8212;surface &lt;*surface name*&gt;</strong></p>
<blockquote>
<div>Name of the surface employed in the visualization. The default is inflated .</div></blockquote>
<p><strong>&#8212;curv &lt;*name*&gt;</strong></p>
<blockquote>
<div>Specify a nonstandard curvature file name. The default curvature files
are <code class="docutils literal"><span class="pre">lh.curv</span></code> and <code class="docutils literal"><span class="pre">rh.curv</span></code> . With this option,
the names become <code class="docutils literal"><span class="pre">lh.</span></code> &lt;<em>name</em>&gt; and <code class="docutils literal"><span class="pre">rh.</span></code> &lt;<em>name</em>&gt; .</div></blockquote>
<p><strong>&#8212;patch &lt;*name*&gt; [: &lt;*angle/deg*&gt; ]</strong></p>
<blockquote>
<div>Specify the name of a surface patch to be used for visualization instead
of the complete cortical surface. A complete name of a patch file
in the FreeSurface surf directory must be given. The name should
begin with lh or rh to allow association of the patch with a hemisphere.
Maximum of two <code class="docutils literal"><span class="pre">--patch</span></code> options can be in effect, one patch for each
hemisphere. If the name refers to a flat patch, the name can be
optionally followed by a colon and a rotation angle in degrees.
The flat patch will be then rotated counterclockwise by this amount
before display. You can check a suitable value for the rotation
angle by loading the patch interactively in mne_analyze .</div></blockquote>
<p><strong>&#8212;width &lt;*value*&gt;</strong></p>
<blockquote>
<div>Width of the graphics output frames in pixels. The default width
is 600 pixels.</div></blockquote>
<p><strong>&#8212;height &lt;*value*&gt;</strong></p>
<blockquote>
<div>Height of the graphics output frames in pixels. The default height
is 400 pixels.</div></blockquote>
<p><strong>&#8212;mag &lt;*factor*&gt;</strong></p>
<blockquote>
<div>Magnify the the visualized scene by this factor.</div></blockquote>
<p><strong>&#8212;lh</strong></p>
<blockquote>
<div>Select the left hemisphere for graphics output. By default, both hemisphere
are processed.</div></blockquote>
<p><strong>&#8212;rh</strong></p>
<blockquote>
<div>Select the right hemisphere for graphics output. By default, both hemisphere
are processed.</div></blockquote>
<p><strong>&#8212;view &lt;*name*&gt;</strong></p>
<blockquote>
<div>Select the name of the view for mov, rgb, and tif graphics output files.
The default viewnames, defined in <code class="docutils literal"><span class="pre">$MNE_ROOT/share/mne/mne_analyze/eyes</span></code> ,
are <em>lat</em> (lateral), <em>med</em> (medial), <em>ven</em> (ventral),
and <em>occ</em> (occipital). You can override these
defaults by creating the directory .mne under your home directory
and copying the eyes file there. Each line of the eyes file contais
the name of the view, the viewpoint for the left hemisphere, the
viewpoint for the right hemisphere, left hemisphere up vector, and
right hemisphere up vector. The entities are separated by semicolons.
Lines beginning with the pound sign (#) are considered to be comments.</div></blockquote>
<p><strong>&#8212;smooth &lt;*nstep*&gt;</strong></p>
<blockquote>
<div>Number of smoothsteps to take when producing the output frames. Depending
on the source space decimation, an appropriate number is 4 - 7.
Smoothing does not have any effect for the original brain if stc
files are produced. However, if morphing is selected smoothing is
mandatory even with stc output. For details of the smoothing procedure,
see <a class="reference internal" href="morph.html#chdebahh"><span>About smoothing</span></a>.</div></blockquote>
<p><strong>&#8212;nocomments</strong></p>
<blockquote>
<div>Do not include the comments in the image output files or movies.</div></blockquote>
<p><strong>&#8212;noscalebar</strong></p>
<blockquote>
<div>Do not include the scalebar in the image output files or movies.</div></blockquote>
<p><strong>&#8212;alpha &lt;*value*&gt;</strong></p>
<blockquote>
<div>Adjust the opacity of maps shown on the cortical surface (0 = transparent,
1 = totally opaque). The default value is 1.</div></blockquote>
</div>
<div class="section" id="thresholding">
<h3>Thresholding<a class="headerlink" href="#thresholding" title="Permalink to this headline">¶</a></h3>
<p><strong>&#8212;fthresh &lt;*value*&gt;</strong></p>
<blockquote>
<div>Specifies the threshold for the displayed colormaps. At the threshold,
the overlayed color will be equal to the background surface color.
For currents, the value will be multiplied by <span class="math">1^{-10}</span>.
The default value is 8.</div></blockquote>
<p><strong>&#8212;fmid &lt;*value*&gt;</strong></p>
<blockquote>
<div>Specifies the midpoint for the displayed colormaps. At this value, the
overlayed color will be read (positive values) or blue (negative values).
For currents, the value will be multiplied by <span class="math">1^{-10}</span>.
The default value is 15.</div></blockquote>
<p><strong>&#8212;fmax &lt;*value*&gt;</strong></p>
<blockquote>
<div>Specifies the maximum point for the displayed colormaps. At this value,
the overlayed color will bright yellow (positive values) or light
blue (negative values). For currents, the value will be multiplied
by <span class="math">1^{-10}</span>. The default value is 20.</div></blockquote>
<p><strong>&#8212;fslope &lt;*value*&gt;</strong></p>
<blockquote>
<div>Included for backwards compatibility. If this option is specified
and <code class="docutils literal"><span class="pre">--fmax</span></code> option is <em>not</em> specified, <span class="math">F_{max} = F_{mid} + 1/F_{slope}</span>.</div></blockquote>
</div>
<div class="section" id="output-files">
<h3>Output files<a class="headerlink" href="#output-files" title="Permalink to this headline">¶</a></h3>
<p><strong>&#8212;mov &lt;*name*&gt;</strong></p>
<blockquote>
<div>Produce QuickTime movie files. This is the &#8216;stem&#8217; of
the ouput file name. The actual name is derived by stripping anything
up to and including the last period from the end of &lt;<em>name</em>&gt; .
According to the hemisphere, <code class="docutils literal"><span class="pre">-lh</span></code> or <code class="docutils literal"><span class="pre">-rh</span></code> is
then appended. The name of the view is indicated with <code class="docutils literal"><span class="pre">-</span></code> &lt;<em>viename</em>&gt; .
Finally, <code class="docutils literal"><span class="pre">.mov</span></code> is added to indicate a QuickTime output
file. The movie is produced for all times as dictated by the <code class="docutils literal"><span class="pre">--tmin</span></code> , <code class="docutils literal"><span class="pre">--tmax</span></code> , <code class="docutils literal"><span class="pre">--tstep</span></code> ,
and <code class="docutils literal"><span class="pre">--integ</span></code> options.</div></blockquote>
<p><strong>&#8212;qual &lt;*value*&gt;</strong></p>
<blockquote>
<div>Quality of the QuickTime movie output. The default quality is 80 and
allowed range is 25 - 100. The size of the movie files is a monotonously
increasing function of the movie quality.</div></blockquote>
<p><strong>&#8212;rate &lt;*rate*&gt;</strong></p>
<blockquote>
<div>Specifies the frame rate of the QuickTime movies. The default value is <span class="math">1/(10t_{step})</span>,
where <span class="math">t_{step}</span> is the time between subsequent
movie frames produced in seconds.</div></blockquote>
<p><strong>&#8212;rgb &lt;*name*&gt;</strong></p>
<blockquote>
<div>Produce rgb snapshots. This is the &#8216;stem&#8217; of the
ouput file name. The actual name is derived by stripping anything
up to and including the last period from the end of &lt;<em>name</em>&gt; .
According to the hemisphere, <code class="docutils literal"><span class="pre">-lh</span></code> or <code class="docutils literal"><span class="pre">-rh</span></code> is
then appended. The name of the view is indicated with <code class="docutils literal"><span class="pre">-</span></code> &lt;<em>viename</em>&gt; .
Finally, <code class="docutils literal"><span class="pre">.rgb</span></code> is added to indicate an rgb output file.
Files are produced for all picked times as dictated by the <code class="docutils literal"><span class="pre">--pick</span></code> and <code class="docutils literal"><span class="pre">--integ</span></code> options.</div></blockquote>
<p><strong>&#8212;tif &lt;*name*&gt;</strong></p>
<blockquote>
<div>Produce tif snapshots. This is the &#8216;stem&#8217; of the
ouput file name. The actual name is derived by stripping anything
up to and including the last period from the end of &lt;<em>name</em>&gt; .
According to the hemisphere, <code class="docutils literal"><span class="pre">-lh</span></code> or <code class="docutils literal"><span class="pre">-rh</span></code> is
then appended. The name of the view is indicated with <code class="docutils literal"><span class="pre">-</span></code> &lt;<em>viename</em>&gt; .
Finally, <code class="docutils literal"><span class="pre">.tif</span></code> is added to indicate an rgb output file.
Files are produced for all picked times as dictated by the <code class="docutils literal"><span class="pre">--pick</span></code> and <code class="docutils literal"><span class="pre">--integ</span></code> options.
The tif output files are <em>not</em> compressed. Pass
the files through an image processing program to compress them.</div></blockquote>
<p><strong>&#8212;jpg &lt;*name*&gt;</strong></p>
<blockquote>
<div>Produce jpg snapshots. This is the &#8216;stem&#8217; of the
ouput file name. The actual name is derived by stripping anything
up to and including the last period from the end of &lt;<em>name</em>&gt; .
According to the hemisphere, <code class="docutils literal"><span class="pre">-lh</span></code> or <code class="docutils literal"><span class="pre">-rh</span></code> is
then appended. The name of the view is indicated with <code class="docutils literal"><span class="pre">-</span></code> &lt;<em>viename</em>&gt; .
Finally, <code class="docutils literal"><span class="pre">.jpg</span></code> is added to indicate an rgb output file.
Files are produced for all picked times as dictated by the <code class="docutils literal"><span class="pre">--pick</span></code> and <code class="docutils literal"><span class="pre">--integ</span></code> options.</div></blockquote>
<p><strong>&#8212;png &lt;*name*&gt;</strong></p>
<blockquote>
<div>Produce png snapshots. This is the &#8216;stem&#8217; of the
ouput file name. The actual name is derived by stripping anything
up to and including the last period from the end of &lt;<em>name</em>&gt; .
According to the hemisphere, <code class="docutils literal"><span class="pre">-lh</span></code> or <code class="docutils literal"><span class="pre">-rh</span></code> is
then appended. The name of the view is indicated with <code class="docutils literal"><span class="pre">-</span></code> &lt;<em>viename</em>&gt; .
Finally, <code class="docutils literal"><span class="pre">.png</span></code> is added to indicate an rgb output file.
Files are produced for all picked times as dictated by the <code class="docutils literal"><span class="pre">--pick</span></code> and <code class="docutils literal"><span class="pre">--integ</span></code> options.</div></blockquote>
<p><strong>&#8212;w &lt;*name*&gt;</strong></p>
<blockquote>
<div>Produce w file snapshots. This is the &#8216;stem&#8217; of
the ouput file name. The actual name is derived by stripping anything
up to and including the last period from the end of &lt;<em>name</em>&gt; .
According to the hemisphere, <code class="docutils literal"><span class="pre">-lh</span></code> .w or <code class="docutils literal"><span class="pre">-rh</span></code> .w
is then appended. Files are produced for all picked times as dictated
by the <code class="docutils literal"><span class="pre">--pick</span></code> and <code class="docutils literal"><span class="pre">--integ</span></code> options.</div></blockquote>
<p><strong>&#8212;stc &lt;*name*&gt;</strong></p>
<blockquote>
<div>Produce stc files for either the original subject or the one selected with
the <code class="docutils literal"><span class="pre">--morph</span></code> option. These files will contain data only
for the decimated locations. If morphing is selected, appropriate
smoothing is mandatory. The morphed maps will be decimated with
help of a subdivided icosahedron so that the morphed stc files will
always contain 10242 vertices. These morphed stc files can be easily
averaged together, e.g., in Matlab since they always contain an
identical set of vertices.</div></blockquote>
<p><strong>&#8212;norm &lt;*name*&gt;</strong></p>
<blockquote>
<div>Indicates that a separate w file
containing the noise-normalization values will be produced. The
option <code class="docutils literal"><span class="pre">--spm</span></code> must also be present. Nevertheless, the
movies and stc files output will
contain MNE values. The noise normalization data files will be called &lt;<em>name</em>&gt;- &lt;<em>SNR</em>&gt; <code class="docutils literal"><span class="pre">-lh.w</span></code> and &lt;<em>name</em>&gt;- &lt;<em>SNR</em>&gt; <code class="docutils literal"><span class="pre">-rh.w</span></code> .</div></blockquote>
</div>
<div class="section" id="label-processing">
<span id="cbbhhcef"></span><h3>Label processing<a class="headerlink" href="#label-processing" title="Permalink to this headline">¶</a></h3>
<p><strong>&#8212;label &lt;*name*&gt;</strong></p>
<blockquote>
<div>Specifies a label file to process. For each label file, the values
of the computed estimates are listed in text files. The label files
are produced by tksurfer or mne_analyze and
specify regions of interests (ROIs). A label file name should end
with <code class="docutils literal"><span class="pre">-lh.label</span></code> for left-hemisphere ROIs and with <code class="docutils literal"><span class="pre">-rh.label</span></code> for
right-hemisphere ones. The corresponding output files are tagged
with <code class="docutils literal"><span class="pre">-lh-</span></code> &lt;<em>data type</em>&gt; <code class="docutils literal"><span class="pre">.amp</span></code> and <code class="docutils literal"><span class="pre">-rh-</span></code> &lt;<em>data type</em>&gt; <code class="docutils literal"><span class="pre">.amp</span></code>, respectively. &lt;<em>data type</em>&gt; equals <code class="docutils literal"><span class="pre">'mne</span></code> &#8216; for
expected current data and <code class="docutils literal"><span class="pre">'spm</span></code> &#8216; for
dSPM data. Each line of the output file contains the waveform of
the output quantity at one of the source locations falling inside
the ROI. For more information about the label output formats, see <a class="reference internal" href="analyze.html#cacjjgfa"><span>Label timecourse files</span></a>.</div></blockquote>
<p><strong>&#8212;labelcoords</strong></p>
<blockquote>
<div>Include coordinates of the vertices in the output. The coordinates will
be listed in millimeters in the coordinate system which was specified
for the forward model computations. This option cannot be used with
stc input files (<code class="docutils literal"><span class="pre">--stcin</span></code> ) because the stc files do
not contain the coordinates of the vertices.</div></blockquote>
<p><strong>&#8212;labelverts</strong></p>
<blockquote>
<div>Include vertex numbers in the output. The numbers refer to the complete
triangulation of the corresponding surface and are zero based. The
vertex numbers are by default on the first row or first column of the
output file depending on whether or not the <code class="docutils literal"><span class="pre">--labeltimebytime</span></code> option
is present.</div></blockquote>
<p><strong>&#8212;labeltimebytime</strong></p>
<blockquote>
<div>Output the label data time by time instead of the default vertex-by-vertex
output.</div></blockquote>
<p><strong>&#8212;labeltag &lt;*tag*&gt;</strong></p>
<blockquote>
<div>End the output files with the specified tag. By default, the output files
will end with <code class="docutils literal"><span class="pre">-mne.amp</span></code> or <code class="docutils literal"><span class="pre">-spm.amp</span></code> depending
on whether MNE or one of the noise-normalized estimates (dSPM or sLORETA)
was selected.</div></blockquote>
<p><strong>&#8212;labeloutdir &lt;*directory*&gt;</strong></p>
<blockquote>
<div>Specifies the directory where the output files will be located.
By default, they will be in the current working directory.</div></blockquote>
<p><strong>&#8212;labelcomments</strong></p>
<blockquote>
<div>Include comments in the output files. The comment lines begin with the
percent sign to make the files compatible with Matlab.</div></blockquote>
<p><strong>&#8212;scaleby &lt;*factor*&gt;</strong></p>
<blockquote>
<div>By default, the current values output to the files will be in the
actual physical units (Am). This option allows scaling of the current
values to other units. mne_analyze typically
uses 1e10 to bring the numbers to a human-friendly scale.</div></blockquote>
</div>
<div class="section" id="using-stc-file-input">
<h3>Using stc file input<a class="headerlink" href="#using-stc-file-input" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal"><span class="pre">--stcin</span></code> option allows input of stc files.
This feature has several uses:</p>
<ul class="simple">
<li>QuickTime movies can be produced from
existing stc files without having to resort to EasyMeg.</li>
<li>Graphics snapshot can be produced from existing stc files.</li>
<li>Existing stc files can be temporally resampled with help of
the <code class="docutils literal"><span class="pre">--tmin</span></code> , <code class="docutils literal"><span class="pre">--tmax</span></code> , <code class="docutils literal"><span class="pre">--tstep</span></code> ,
and <code class="docutils literal"><span class="pre">--integ</span></code> options.</li>
<li>Existing stc files can be morphed to another cortical surface
by specifying the <code class="docutils literal"><span class="pre">--morph</span></code> option.</li>
<li>Timecourses can be inquired and stored into text files with
help of the <code class="docutils literal"><span class="pre">--label</span></code> options, see above.</li>
</ul>
</div>
</div>
<div class="section" id="computing-inverse-from-raw-and-evoked-data">
<span id="cbbcghah"></span><h2>Computing inverse from raw and evoked data<a class="headerlink" href="#computing-inverse-from-raw-and-evoked-data" title="Permalink to this headline">¶</a></h2>
<p>The purpose of the utility mne_compute_raw_inverse is
to compute inverse solutions from either evoked-response or raw
data at specified ROIs (labels) and to save the results in a fif
file which can be viewed with mne_browse_raw ,
read to Matlab directly using the MNE Matlab Toolbox, see <a class="reference internal" href="matlab.html#ch-matlab"><span>The Matlab toolbox</span></a>,
or converted to Matlab format using either mne_convert_mne_data , mne_raw2mat ,
or mne_epochs2mat , see <a class="reference internal" href="convert.html#ch-convert"><span>Data conversion</span></a>.</p>
<div class="section" id="command-line-options">
<span id="chdeihfa"></span><h3>Command-line options<a class="headerlink" href="#command-line-options" title="Permalink to this headline">¶</a></h3>
<p><strong>&#8212;version</strong></p>
<blockquote>
<div>Show the program version and compilation date.</div></blockquote>
<p><strong>&#8212;help</strong></p>
<blockquote>
<div>List the command-line options.</div></blockquote>
<p><strong>&#8212;in &lt;*filename*&gt;</strong></p>
<blockquote>
<div>Specifies the input data file. This can be either an evoked data
file or a raw data file.</div></blockquote>
<p><strong>&#8212;bmin &lt;*time/ms*&gt;</strong></p>
<blockquote>
<div>Specifies the starting time of the baseline. In order to activate
baseline correction, both <code class="docutils literal"><span class="pre">--bmin</span></code> and <code class="docutils literal"><span class="pre">--bmax</span></code> options
must be present. This option applies to evoked data only.</div></blockquote>
<p><strong>&#8212;bmax &lt;*time/ms*&gt;</strong></p>
<blockquote>
<div>Specifies the finishing time of the baseline. This option applies
to evoked data only.</div></blockquote>
<p><strong>&#8212;set &lt;*number*&gt;</strong></p>
<blockquote>
<div>The data set (condition) number to load. This is the sequential
number of the condition. You can easily see the association by looking
at the condition list in mne_analyze when
you load the file.</div></blockquote>
<p><strong>&#8212;inv &lt;*name*&gt;</strong></p>
<blockquote>
<div>Load the inverse operator decomposition from here.</div></blockquote>
<p><strong>&#8212;nave &lt;*value*&gt;</strong></p>
<blockquote>
<div>Specifies the effective number of averaged epochs in the input data, <span class="math">L_{eff}</span>,
as discussed in <a class="reference internal" href="#cbbdgiae"><span>Effective number of averages</span></a>. If the input data file is
one produced by mne_browse_raw or mne_process_raw ,
the number of averages is correct in the file. However, if subtractions
or some more complicated combinations of simple averages are produced,
e.g., by  using the xplotter software,
the number of averages should be manually adjusted along the guidelines
given in <a class="reference internal" href="#cbbdgiae"><span>Effective number of averages</span></a>. This is accomplished either by
employing this flag or by adjusting the number of averages in the
data file with help of the utility mne_change_nave .</div></blockquote>
<p><strong>&#8212;snr &lt;*value*&gt;</strong></p>
<blockquote>
<div>An estimate for the amplitude SNR. The regularization parameter will
be set as <span class="math">\lambda^2 = 1/SNR^2</span>. The default value is
SNR = 1. Automatic selection of the regularization parameter is
currently not supported.</div></blockquote>
<p><strong>&#8212;spm</strong></p>
<blockquote>
<div>Calculate the dSPM instead of the expected current value.</div></blockquote>
<p><strong>&#8212;picknormalcomp</strong></p>
<blockquote>
<div>The components of the estimates corresponding to directions tangential
with the cortical mantle are zeroed out.</div></blockquote>
<p><strong>&#8212;mricoord</strong></p>
<blockquote>
<div>Provide source locations and orientations in the MRI coordinate frame
instead of the default head coordinate frame.</div></blockquote>
<p><strong>&#8212;label &lt;*name*&gt;</strong></p>
<blockquote>
<div>Specifies a label file to process. For each label file, the values
of the computed estimates stored in a fif file. For more details,
see <a class="reference internal" href="#cbbhjdai"><span>Implementation details</span></a>. The label files are produced by tksurfer
or mne_analyze and specify regions
of interests (ROIs). A label file name should end with <code class="docutils literal"><span class="pre">-lh.label</span></code> for
left-hemisphere ROIs and with <code class="docutils literal"><span class="pre">-rh.label</span></code> for right-hemisphere
ones. The corresponding output files are tagged with <code class="docutils literal"><span class="pre">-lh-</span></code> &lt;<em>data type</em>&gt; <code class="docutils literal"><span class="pre">.fif</span></code> and <code class="docutils literal"><span class="pre">-rh-</span></code> &lt;<em>data type</em>&gt; <code class="docutils literal"><span class="pre">.fif</span></code> , respectively. &lt;<em>data type</em>&gt; equals <code class="docutils literal"><span class="pre">'mne</span></code> &#8216; for expected
current data and <code class="docutils literal"><span class="pre">'spm</span></code> &#8216; for dSPM data.
For raw data, <code class="docutils literal"><span class="pre">_raw.fif</span></code> is employed instead of <code class="docutils literal"><span class="pre">.fif</span></code> .
The output files are stored in the same directory as the label files.</div></blockquote>
<p><strong>&#8212;labelselout</strong></p>
<blockquote>
<div>Produces additional label files for each label processed, containing only
those vertices within the input label which correspond to available
source space vertices in the inverse operator. These files have the
same name as the original label except that <code class="docutils literal"><span class="pre">-lh</span></code> and <code class="docutils literal"><span class="pre">-rh</span></code> are replaced
by <code class="docutils literal"><span class="pre">-sel-lh</span></code> and <code class="docutils literal"><span class="pre">-sel-rh</span></code> , respectively.</div></blockquote>
<p><strong>&#8212;align_z</strong></p>
<blockquote>
<div>Instructs the program to try to align the waveform signs within
the label. For more information, see <a class="reference internal" href="#cbbhjdai"><span>Implementation details</span></a>. This
flag will not have any effect if the inverse operator has been computed
with the strict orientation constraint active.</div></blockquote>
<p><strong>&#8212;labeldir &lt;*directory*&gt;</strong></p>
<blockquote>
<div>All previous <code class="docutils literal"><span class="pre">--label</span></code> options will be ignored when this
option is encountered. For each label in the directory, the output
file defined with the <code class="docutils literal"><span class="pre">--out</span></code> option will contain a summarizing
waveform which is the average of the waveforms in the vertices of
the label. The <code class="docutils literal"><span class="pre">--labeldir</span></code> option implies <code class="docutils literal"><span class="pre">--align_z</span></code> and <code class="docutils literal"><span class="pre">--picknormalcomp</span></code> options.</div></blockquote>
<p><strong>&#8212;orignames</strong></p>
<blockquote>
<div>This option is used with the <code class="docutils literal"><span class="pre">--labeldir</span></code> option, above.
With this option, the output file channel names will be the names
of the label files, truncated to 15 characters, instead of names
containing the vertex numbers.</div></blockquote>
<p><strong>&#8212;out &lt;*name*&gt;</strong></p>
<blockquote>
<div>Required with <code class="docutils literal"><span class="pre">--labeldir</span></code> . This is the output file for
the data.</div></blockquote>
<p><strong>&#8212;extra &lt;*name*&gt;</strong></p>
<blockquote>
<div>By default, the output includes the current estimate signals and
the digital trigger channel, see <code class="docutils literal"><span class="pre">--digtrig</span></code> option,
below. With the <code class="docutils literal"><span class="pre">--extra</span></code> option, a custom set of additional
channels can be included. The extra channel text file should contain
the names of these channels, one channel name on each line. With
this option present, the digital trigger channel is not included
unless specified in the extra channel file.</div></blockquote>
<p><strong>&#8212;noextra</strong></p>
<blockquote>
<div>No additional channels will be included with this option present.</div></blockquote>
<p><strong>&#8212;digtrig &lt;*name*&gt;</strong></p>
<blockquote>
<div>Name of the composite digital trigger channel. The default value
is &#8216;STI 014&#8217;. Underscores in the channel name
will be replaced by spaces.</div></blockquote>
<p><strong>&#8212;split &lt;*size/MB*&gt;</strong></p>
<blockquote>
<div>Specifies the maximum size of the raw data files saved. By default, the
output is split into files which are just below 2 GB so that the
fif file maximum size is not exceed.</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The digital trigger channel can also be set with    the MNE_TRIGGER_CH_NAME environment variable. Underscores in the variable    value will <em>not</em> be replaced with spaces by mne_compute_raw_inverse .    Using the <code class="docutils literal"><span class="pre">--digtrig</span></code> option supersedes the MNE_TRIGGER_CH_NAME    environment variable.</p>
</div>
</div>
<div class="section" id="implementation-details">
<span id="cbbhjdai"></span><h3>Implementation details<a class="headerlink" href="#implementation-details" title="Permalink to this headline">¶</a></h3>
<p>The fif files output from mne_compute_raw_inverse have
various fields of the channel information set to facilitate interpretation
by postprocessing software as follows:</p>
<p><strong>channel name</strong></p>
<blockquote>
<div>Will be set to J[xyz] &lt;<em>number</em>&gt; ,
where the source component is indicated by the coordinat axis name
and number is the vertex number, starting from zero, in the complete
triangulation of the hemisphere in question.</div></blockquote>
<p><strong>logical channel number</strong></p>
<blockquote>
<div>Will be set to is the vertex number, starting from zero, in the
complete triangulation of the hemisphere in question.</div></blockquote>
<p><strong>sensor location</strong></p>
<blockquote>
<div>The location of the vertex in head coordinates or in MRI coordinates,
determined by the <code class="docutils literal"><span class="pre">--mricoord</span></code> flag.</div></blockquote>
<p><strong>sensor orientation</strong></p>
<blockquote>
<div>The <em>x</em>-direction unit vector will point to the
direction of the current. Other unit vectors are set to zero. Again,
the coordinate system in which the orientation is expressed depends
on the <code class="docutils literal"><span class="pre">--mricoord</span></code> flag.</div></blockquote>
<p>The <code class="docutils literal"><span class="pre">--align_z</span></code> flag tries to align the signs
of the signals at different vertices of the label. For this purpose,
the surface normals within the label are collected into a <span class="math">n_{vert} \times 3</span> matrix.
The preferred orientation will be taken as the first right singular
vector of this matrix, corresponding to its largest singular value.
If the dot product of the surface normal of a vertex is negative,
the sign of the estimates at this vertex are inverted. The inversion
is reflected in the current direction vector listed in the channel
information, see above.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The raw data files output by mne_compute_raw_inverse can be converted to mat files with mne_raw2mat, see <a class="reference internal" href="convert.html#convert-to-matlab"><span>Converting raw data to Matlab format</span></a>. Alternatively, the files can be read directly from Matlab using the routines in the MNE Matlab toolbox, see <a class="reference internal" href="matlab.html#ch-matlab"><span>The Matlab toolbox</span></a>. The evoked data output can be easily read directly from Matlab using the fiff_load_evoked routine in the MNE Matlab toolbox. Both raw data and evoked output files can be loaded into mne_browse_raw, see <a class="reference internal" href="browse.html#ch-browse"><span>Processing raw data</span></a>.</p>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2012-2015, MNE Developers.
      Last updated on May 22, 2015.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4a0+.
    </div>
  </body>
</html>